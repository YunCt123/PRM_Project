<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/prm_project/activies/VerifyAccountActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/prm_project/activies/VerifyAccountActivity.java" />
              <option name="originalContent" value="package com.example.prm_project.activies;&#10;&#10;import android.Manifest;&#10;import android.app.AlertDialog;&#10;import android.content.Intent;&#10;import android.content.pm.PackageManager;&#10;import android.graphics.Bitmap;&#10;import android.graphics.BitmapFactory;&#10;import android.net.Uri;&#10;import android.os.Build;&#10;import android.os.Bundle;&#10;import android.provider.MediaStore;&#10;import android.util.Log;&#10;import android.view.View;&#10;import android.widget.EditText;&#10;import android.widget.FrameLayout;&#10;import android.widget.ImageButton;&#10;import android.widget.ImageView;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;&#10;import androidx.activity.result.ActivityResultLauncher;&#10;import androidx.activity.result.contract.ActivityResultContracts;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.core.app.ActivityCompat;&#10;import androidx.core.content.ContextCompat;&#10;&#10;import com.example.prm_project.R;&#10;import com.example.prm_project.api.ApiClient;&#10;import com.example.prm_project.api.UserApiService;&#10;import com.example.prm_project.models.ApiResponse;&#10;import com.example.prm_project.models.User;&#10;import com.example.prm_project.utils.SessionManager;&#10;import com.google.android.material.button.MaterialButton;&#10;&#10;import java.io.File;&#10;import java.io.FileOutputStream;&#10;import java.io.InputStream;&#10;import java.util.concurrent.ExecutorService;&#10;import java.util.concurrent.Executors;&#10;&#10;import okhttp3.MediaType;&#10;import okhttp3.MultipartBody;&#10;import okhttp3.RequestBody;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;public class VerifyAccountActivity extends AppCompatActivity {&#10;&#10;    private static final String TAG = &quot;VerifyAccount&quot;;&#10;    private static final int PERMISSION_REQUEST_CODE = 1001;&#10;&#10;    private ImageButton btnBack;&#10;    private FrameLayout layoutIdFront, layoutIdBack, layoutLicenseFront, layoutLicenseBack;&#10;    private ImageView ivIdFront, ivIdBack, ivLicenseFront, ivLicenseBack;&#10;    private View placeholderIdFront, placeholderIdBack, placeholderLicenseFront, placeholderLicenseBack;&#10;    private MaterialButton btnSubmit;&#10;    private TextView tvKycStatus;&#10;&#10;    private Uri idFrontUri, idBackUri, licenseFrontUri, licenseBackUri;&#10;    private int currentImageType = 0; // 1: ID Front, 2: ID Back, 3: License Front, 4: License Back&#10;&#10;    private ActivityResultLauncher&lt;Intent&gt; imagePickerLauncher;&#10;    private UserApiService userApiService;&#10;    private SessionManager sessionManager;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_verify_account);&#10;&#10;        initViews();&#10;&#10;        // Initialize session manager and API&#10;        sessionManager = new SessionManager(this);&#10;        userApiService = ApiClient.getClient().create(UserApiService.class);&#10;&#10;        // Request runtime permission early so user can pick images&#10;        checkAndRequestStoragePermission();&#10;&#10;        setupImagePicker();&#10;        setupListeners();&#10;&#10;        // Update UI according to current verification status&#10;        updateStatusFromSession();&#10;    }&#10;&#10;    private void initViews() {&#10;        btnBack = findViewById(R.id.btnBack);&#10;        layoutIdFront = findViewById(R.id.layoutIdFront);&#10;        layoutIdBack = findViewById(R.id.layoutIdBack);&#10;        layoutLicenseFront = findViewById(R.id.layoutLicenseFront);&#10;        layoutLicenseBack = findViewById(R.id.layoutLicenseBack);&#10;        btnSubmit = findViewById(R.id.btnSubmit);&#10;        tvKycStatus = findViewById(R.id.tvKycStatus);&#10;&#10;        // ImageViews for preview&#10;        ivIdFront = findViewById(R.id.ivIdFront);&#10;        ivIdBack = findViewById(R.id.ivIdBack);&#10;        ivLicenseFront = findViewById(R.id.ivLicenseFront);&#10;        ivLicenseBack = findViewById(R.id.ivLicenseBack);&#10;&#10;        // Placeholders&#10;        placeholderIdFront = findViewById(R.id.layoutIdFrontPlaceholder);&#10;        placeholderIdBack = findViewById(R.id.layoutIdBackPlaceholder);&#10;        placeholderLicenseFront = findViewById(R.id.layoutLicenseFrontPlaceholder);&#10;        placeholderLicenseBack = findViewById(R.id.layoutLicenseBackPlaceholder);&#10;    }&#10;&#10;    private void setupImagePicker() {&#10;        imagePickerLauncher = registerForActivityResult(&#10;            new ActivityResultContracts.StartActivityForResult(),&#10;            result -&gt; {&#10;                if (result.getResultCode() == RESULT_OK &amp;&amp; result.getData() != null) {&#10;                    Uri selectedImageUri = result.getData().getData();&#10;&#10;                    if (selectedImageUri == null) {&#10;                        Toast.makeText(this, &quot;Không thể lấy ảnh đã chọn&quot;, Toast.LENGTH_SHORT).show();&#10;                        return;&#10;                    }&#10;&#10;                    switch (currentImageType) {&#10;                        case 1:&#10;                            idFrontUri = selectedImageUri;&#10;                            showImagePreview(ivIdFront, placeholderIdFront, selectedImageUri);&#10;                            Toast.makeText(this, &quot;Đã chọn ảnh CMND/CCCD mặt trước&quot;, Toast.LENGTH_SHORT).show();&#10;                            break;&#10;                        case 2:&#10;                            idBackUri = selectedImageUri;&#10;                            showImagePreview(ivIdBack, placeholderIdBack, selectedImageUri);&#10;                            Toast.makeText(this, &quot;Đã chọn ảnh CMND/CCCD mặt sau&quot;, Toast.LENGTH_SHORT).show();&#10;                            break;&#10;                        case 3:&#10;                            licenseFrontUri = selectedImageUri;&#10;                            showImagePreview(ivLicenseFront, placeholderLicenseFront, selectedImageUri);&#10;                            Toast.makeText(this, &quot;Đã chọn ảnh giấy phép lái xe mặt trước&quot;, Toast.LENGTH_SHORT).show();&#10;                            break;&#10;                        case 4:&#10;                            licenseBackUri = selectedImageUri;&#10;                            showImagePreview(ivLicenseBack, placeholderLicenseBack, selectedImageUri);&#10;                            Toast.makeText(this, &quot;Đã chọn ảnh giấy phép lái xe mặt sau&quot;, Toast.LENGTH_SHORT).show();&#10;                            break;&#10;                    }&#10;&#10;                    checkAllUploaded();&#10;                }&#10;            }&#10;        );&#10;    }&#10;&#10;    private void showImagePreview(ImageView imageView, View placeholder, Uri imageUri) {&#10;        // Set image URI and show image view&#10;        imageView.setImageURI(imageUri);&#10;        imageView.setVisibility(View.VISIBLE);&#10;        placeholder.setVisibility(View.GONE);&#10;    }&#10;&#10;    private void setupListeners() {&#10;        btnBack.setOnClickListener(v -&gt; finish());&#10;&#10;        // Upload listeners - open image picker&#10;        layoutIdFront.setOnClickListener(v -&gt; {&#10;            currentImageType = 1;&#10;            openImagePicker();&#10;        });&#10;&#10;        layoutIdBack.setOnClickListener(v -&gt; {&#10;            currentImageType = 2;&#10;            openImagePicker();&#10;        });&#10;&#10;        layoutLicenseFront.setOnClickListener(v -&gt; {&#10;            currentImageType = 3;&#10;            openImagePicker();&#10;        });&#10;&#10;        layoutLicenseBack.setOnClickListener(v -&gt; {&#10;            currentImageType = 4;&#10;            openImagePicker();&#10;        });&#10;&#10;        btnSubmit.setOnClickListener(v -&gt; {&#10;            if (idFrontUri == null || idBackUri == null || licenseFrontUri == null || licenseBackUri == null) {&#10;                Toast.makeText(this, &quot;Vui lòng chọn đầy đủ ảnh giấy tờ&quot;, Toast.LENGTH_SHORT).show();&#10;                return;&#10;            }&#10;&#10;            uploadKYCDocuments();&#10;        });&#10;    }&#10;&#10;    private void openImagePicker() {&#10;        Intent intent = new Intent(Intent.ACTION_PICK, MediaStore.Images.Media.EXTERNAL_CONTENT_URI);&#10;        imagePickerLauncher.launch(intent);&#10;    }&#10;&#10;    private void checkAllUploaded() {&#10;        if (idFrontUri != null &amp;&amp; idBackUri != null &amp;&amp; licenseFrontUri != null &amp;&amp; licenseBackUri != null) {&#10;            btnSubmit.setEnabled(true);&#10;            btnSubmit.setBackgroundTintList(getResources().getColorStateList(R.color.primary_green, null));&#10;        }&#10;    }&#10;&#10;    private void uploadKYCDocuments() {&#10;        // Show loading&#10;        btnSubmit.setEnabled(false);&#10;        btnSubmit.setText(&quot;Đang chuẩn bị...&quot;);&#10;&#10;        // Get token from SessionManager&#10;        String token = sessionManager.getToken();&#10;        Log.d(TAG, &quot;Token: &quot; + token);&#10;        if (token == null || token.isEmpty()) {&#10;            Toast.makeText(this, &quot;Vui lòng đăng nhập lại&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        // Move heavy image processing to background thread&#10;        ExecutorService executor = Executors.newSingleThreadExecutor();&#10;        executor.execute(() -&gt; {&#10;            try {&#10;                // Convert URIs to MultipartBody.Part in background thread&#10;                MultipartBody.Part idFrontPart = prepareFilePart(&quot;kyc.idFrontImage&quot;, idFrontUri);&#10;                MultipartBody.Part idBackPart = prepareFilePart(&quot;kyc.idBackImage&quot;, idBackUri);&#10;                MultipartBody.Part licenseFrontPart = prepareFilePart(&quot;kyc.licenseFrontImage&quot;, licenseFrontUri);&#10;                MultipartBody.Part licenseBackPart = prepareFilePart(&quot;kyc.licenseBackImage&quot;, licenseBackUri);&#10;&#10;                Log.d(TAG, &quot;Files prepared: &quot; + (idFrontPart != null) + &quot;, &quot; + (idBackPart != null) + &quot;, &quot; + (licenseFrontPart != null) + &quot;, &quot; + (licenseBackPart != null));&#10;&#10;                // Return to main thread to check results and call API&#10;                runOnUiThread(() -&gt; {&#10;                    if (idFrontPart == null || idBackPart == null || licenseFrontPart == null || licenseBackPart == null) {&#10;                        Toast.makeText(this, &quot;Lỗi khi chuẩn bị file, vui lòng thử lại&quot;, Toast.LENGTH_SHORT).show();&#10;                        btnSubmit.setEnabled(true);&#10;                        btnSubmit.setText(&quot;Gửi xác minh&quot;);&#10;                        return;&#10;                    }&#10;&#10;                    btnSubmit.setText(&quot;Đang tải lên...&quot;);&#10;&#10;                    // Get current user from session&#10;                    User currentUser = sessionManager.getUserDetails();&#10;                    String userName = (currentUser != null &amp;&amp; currentUser.getName() != null) ? currentUser.getName().trim() : &quot;&quot;;&#10;&#10;                    if (userName.isEmpty()) {&#10;                        // Backend requires 'name' field — ask user to update profile&#10;                        EditText input = new EditText(VerifyAccountActivity.this);&#10;                        input.setHint(&quot;Họ và tên&quot;);&#10;                        new AlertDialog.Builder(VerifyAccountActivity.this)&#10;                                .setTitle(&quot;Tên bắt buộc&quot;)&#10;                                .setMessage(&quot;Backend yêu cầu trường tên. Vui lòng nhập tên để tiếp tục gửi xác minh.&quot;)&#10;                                .setView(input)&#10;                                .setPositiveButton(&quot;Gửi&quot;, (dialog, which) -&gt; {&#10;                                    String entered = input.getText() != null ? input.getText().toString().trim() : &quot;&quot;;&#10;                                    if (entered.isEmpty()) {&#10;                                        Toast.makeText(VerifyAccountActivity.this, &quot;Tên không được để trống&quot;, Toast.LENGTH_SHORT).show();&#10;                                        btnSubmit.setEnabled(true);&#10;                                        btnSubmit.setText(&quot;Gửi xác minh&quot;);&#10;                                        return;&#10;                                    }&#10;                                    submitWithName(entered, currentUser, token, idFrontPart, idBackPart, licenseFrontPart, licenseBackPart);&#10;                                })&#10;                                .setNegativeButton(&quot;Hủy&quot;, (dialog, which) -&gt; {&#10;                                    btnSubmit.setEnabled(true);&#10;                                    btnSubmit.setText(&quot;Gửi xác minh&quot;);&#10;                                    dialog.dismiss();&#10;                                })&#10;                                .setCancelable(false)&#10;                                .show();&#10;                        return;&#10;                    }&#10;&#10;                    // Create multipart text part for name&#10;                    MultipartBody.Part namePart = MultipartBody.Part.createFormData(&quot;name&quot;, null, RequestBody.create(MediaType.parse(&quot;text/plain&quot;), userName));&#10;                    RequestBody phone = RequestBody.create(MediaType.parse(&quot;text/plain&quot;), (currentUser != null &amp;&amp; currentUser.getPhone() != null) ? currentUser.getPhone() : &quot;&quot;);&#10;                    RequestBody gender = RequestBody.create(MediaType.parse(&quot;text/plain&quot;), (currentUser != null &amp;&amp; currentUser.getGender() != null) ? currentUser.getGender() : &quot;&quot;);&#10;&#10;                    // Call API&#10;                    Call&lt;ApiResponse&lt;User&gt;&gt; call = userApiService.updateProfile(&#10;                        &quot;Bearer &quot; + token,&#10;                        namePart,&#10;                        phone,&#10;                        gender,&#10;                        null,&#10;                        licenseFrontPart,&#10;                        licenseBackPart,&#10;                        idFrontPart,&#10;                        idBackPart&#10;                    );&#10;&#10;                    call.enqueue(new Callback&lt;ApiResponse&lt;User&gt;&gt;() {&#10;                        @Override&#10;                        public void onResponse(Call&lt;ApiResponse&lt;User&gt;&gt; call, Response&lt;ApiResponse&lt;User&gt;&gt; response) {&#10;                            btnSubmit.setEnabled(true);&#10;                            btnSubmit.setText(&quot;Gửi xác minh&quot;);&#10;&#10;                            Log.d(TAG, &quot;Response code: &quot; + response.code());&#10;&#10;                            if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                                ApiResponse&lt;User&gt; apiResponse = response.body();&#10;                                Log.d(TAG, &quot;Response success: &quot; + apiResponse.isSuccess() + &quot;, message: &quot; + apiResponse.getMessage());&#10;                                if (apiResponse.isSuccess()) {&#10;                                    User updatedUser = apiResponse.getData();&#10;&#10;                                    if (updatedUser != null) {&#10;                                        sessionManager.createLoginSession(updatedUser, token);&#10;                                        Log.d(TAG, &quot;Updated user saved to session. KYC status: &quot; + updatedUser.getVerificationStatus());&#10;                                    }&#10;&#10;                                    updateStatusFromSession();&#10;&#10;                                    Toast.makeText(VerifyAccountActivity.this,&#10;                                        &quot;Đã gửi yêu cầu xác minh thành công!&quot;,&#10;                                        Toast.LENGTH_LONG).show();&#10;                                } else {&#10;                                    Log.e(TAG, &quot;API returned success=false: &quot; + apiResponse.getMessage());&#10;                                    Toast.makeText(VerifyAccountActivity.this,&#10;                                        &quot;Lỗi: &quot; + apiResponse.getMessage(),&#10;                                        Toast.LENGTH_SHORT).show();&#10;                                }&#10;                            } else {&#10;                                String err = &quot;Không thể kết nối server. Code: &quot; + response.code();&#10;                                try {&#10;                                    if (response.errorBody() != null) {&#10;                                        String errBody = response.errorBody().string();&#10;                                        Log.e(TAG, &quot;Error body: &quot; + errBody);&#10;                                        err += &quot;\n&quot; + errBody;&#10;                                    }&#10;                                } catch (Exception ex) {&#10;                                    Log.w(TAG, &quot;Error reading errorBody&quot;, ex);&#10;                                }&#10;                                Toast.makeText(VerifyAccountActivity.this, err, Toast.LENGTH_LONG).show();&#10;                            }&#10;                        }&#10;&#10;                        @Override&#10;                        public void onFailure(Call&lt;ApiResponse&lt;User&gt;&gt; call, Throwable t) {&#10;                            btnSubmit.setEnabled(true);&#10;                            btnSubmit.setText(&quot;Gửi xác minh&quot;);&#10;                            Log.e(TAG, &quot;Upload failure: &quot; + t.getClass().getSimpleName() + &quot; - &quot; + t.getMessage(), t);&#10;&#10;                            String errorMsg = &quot;Lỗi kết nối: &quot;;&#10;                            if (t instanceof java.net.SocketTimeoutException) {&#10;                                errorMsg += &quot;Timeout - kiểm tra kết nối mạng hoặc thử ảnh nhỏ hơn&quot;;&#10;                            } else if (t instanceof java.net.UnknownHostException) {&#10;                                errorMsg += &quot;Không thể kết nối server - kiểm tra internet&quot;;&#10;                            } else {&#10;                                errorMsg += t.getMessage();&#10;                            }&#10;&#10;                            Toast.makeText(VerifyAccountActivity.this, errorMsg, Toast.LENGTH_LONG).show();&#10;                        }&#10;                    });&#10;                });&#10;&#10;            } catch (Exception e) {&#10;                Log.e(TAG, &quot;Exception in background thread&quot;, e);&#10;                runOnUiThread(() -&gt; {&#10;                    btnSubmit.setEnabled(true);&#10;                    btnSubmit.setText(&quot;Gửi xác minh&quot;);&#10;                    Toast.makeText(this, &quot;Lỗi: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                });&#10;            } finally {&#10;                executor.shutdown();&#10;            }&#10;        });&#10;    }&#10;&#10;    private MultipartBody.Part prepareFilePart(String partName, Uri fileUri) {&#10;        try {&#10;            if (fileUri == null) return null;&#10;&#10;            // Create a temporary file&#10;            File file = new File(getCacheDir(), &quot;upload_&quot; + System.currentTimeMillis() + &quot;.jpg&quot;);&#10;&#10;            // Copy and COMPRESS content from Uri to file&#10;            InputStream inputStream = getContentResolver().openInputStream(fileUri);&#10;            if (inputStream == null) {&#10;                Log.w(TAG, &quot;Input stream is null for uri: &quot; + fileUri);&#10;                return null;&#10;            }&#10;&#10;            // Decode and compress bitmap to reduce file size&#10;            Bitmap bitmap = BitmapFactory.decodeStream(inputStream);&#10;            inputStream.close();&#10;&#10;            if (bitmap == null) {&#10;                Log.w(TAG, &quot;Failed to decode bitmap from uri: &quot; + fileUri);&#10;                return null;&#10;            }&#10;&#10;            // Compress to JPEG with quality 70% to reduce size significantly&#10;            FileOutputStream outputStream = new FileOutputStream(file);&#10;            bitmap.compress(Bitmap.CompressFormat.JPEG, 70, outputStream);&#10;            outputStream.close();&#10;            bitmap.recycle();&#10;&#10;            Log.d(TAG, &quot;Compressed file &quot; + partName + &quot;: &quot; + file.length() + &quot; bytes&quot;);&#10;&#10;            // Create RequestBody&#10;            RequestBody requestFile = RequestBody.create(&#10;                MediaType.parse(&quot;image/jpeg&quot;),&#10;                file&#10;            );&#10;&#10;            return MultipartBody.Part.createFormData(partName, file.getName(), requestFile);&#10;&#10;        } catch (Exception e) {&#10;            Log.e(TAG, &quot;prepareFilePart error for &quot; + partName, e);&#10;            return null;&#10;        }&#10;    }&#10;&#10;    private void checkAndRequestStoragePermission() {&#10;        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.TIRAMISU) {&#10;            // Android 13+: READ_MEDIA_IMAGES&#10;            if (ContextCompat.checkSelfPermission(this, Manifest.permission.READ_MEDIA_IMAGES) != PackageManager.PERMISSION_GRANTED) {&#10;                ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.READ_MEDIA_IMAGES}, PERMISSION_REQUEST_CODE);&#10;            }&#10;        } else {&#10;            // Older versions: READ_EXTERNAL_STORAGE&#10;            if (ContextCompat.checkSelfPermission(this, Manifest.permission.READ_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED) {&#10;                ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.READ_EXTERNAL_STORAGE}, PERMISSION_REQUEST_CODE);&#10;            }&#10;        }&#10;    }&#10;&#10;    @Override&#10;    public void onRequestPermissionsResult(int requestCode, String[] permissions, int[] grantResults) {&#10;        super.onRequestPermissionsResult(requestCode, permissions, grantResults);&#10;        if (requestCode == PERMISSION_REQUEST_CODE) {&#10;            if (grantResults.length &gt; 0 &amp;&amp; grantResults[0] == PackageManager.PERMISSION_GRANTED) {&#10;                Toast.makeText(this, &quot;Đã cấp quyền truy cập ảnh&quot;, Toast.LENGTH_SHORT).show();&#10;            } else {&#10;                Toast.makeText(this, &quot;Cần cấp quyền để chọn ảnh&quot;, Toast.LENGTH_SHORT).show();&#10;            }&#10;        }&#10;    }&#10;&#10;    private void updateStatusFromSession() {&#10;        if (sessionManager == null) return;&#10;        String kyc = sessionManager.getKycStatus();&#10;        boolean verified = sessionManager.isVerified();&#10;&#10;        String statusText = &quot;Trạng thái: &quot;;&#10;        if (verified) {&#10;            statusText += &quot;Đã xác minh&quot;;&#10;            disableInputsForStatus();&#10;        } else if (kyc != null &amp;&amp; (kyc.equalsIgnoreCase(&quot;pending&quot;) || kyc.equalsIgnoreCase(&quot;submitted&quot;))) {&#10;            statusText += &quot;Đang chờ xác minh&quot;;&#10;            disableInputsForStatus();&#10;        } else {&#10;            statusText += &quot;Chưa gửi&quot;;&#10;            enableInputsForEditing();&#10;        }&#10;&#10;        tvKycStatus.setText(statusText);&#10;    }&#10;&#10;    private void disableInputsForStatus() {&#10;        layoutIdFront.setClickable(false);&#10;        layoutIdBack.setClickable(false);&#10;        layoutLicenseFront.setClickable(false);&#10;        layoutLicenseBack.setClickable(false);&#10;        btnSubmit.setEnabled(false);&#10;    }&#10;&#10;    private void enableInputsForEditing() {&#10;        layoutIdFront.setClickable(true);&#10;        layoutIdBack.setClickable(true);&#10;        layoutLicenseFront.setClickable(true);&#10;        layoutLicenseBack.setClickable(true);&#10;        // btnSubmit will be enabled only after all images selected&#10;        checkAllUploaded();&#10;    }&#10;&#10;    @Override&#10;    protected void onResume() {&#10;        super.onResume();&#10;        // Refresh profile from backend to get latest KYC status when user returns&#10;        refreshProfileFromApi();&#10;    }&#10;&#10;    private void refreshProfileFromApi() {&#10;        if (sessionManager == null || userApiService == null) return;&#10;        String token = sessionManager.getToken();&#10;        if (token == null || token.isEmpty()) return;&#10;&#10;        Call&lt;ApiResponse&lt;User&gt;&gt; call = userApiService.getUserProfile(&quot;Bearer &quot; + token);&#10;        call.enqueue(new Callback&lt;ApiResponse&lt;User&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;ApiResponse&lt;User&gt;&gt; call, Response&lt;ApiResponse&lt;User&gt;&gt; response) {&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null &amp;&amp; response.body().isSuccess()) {&#10;                    User user = response.body().getData();&#10;                    if (user != null) {&#10;                        // Persist the latest user (including kyc/isVerified)&#10;                        sessionManager.createLoginSession(user, token);&#10;                        // Update UI&#10;                        updateStatusFromSession();&#10;                        Log.d(TAG, &quot;Profile refreshed, kyc=&quot; + user.getVerificationStatus());&#10;                    }&#10;                } else {&#10;                    Log.w(TAG, &quot;refreshProfileFromApi failed: code=&quot; + response.code());&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;ApiResponse&lt;User&gt;&gt; call, Throwable t) {&#10;                Log.w(TAG, &quot;refreshProfileFromApi onFailure&quot;, t);&#10;            }&#10;        });&#10;    }&#10;&#10;    // Helper to submit when name was entered by user in dialog&#10;    private void submitWithName(String enteredName, User currentUser, String token,&#10;                                MultipartBody.Part idFrontPart,&#10;                                MultipartBody.Part idBackPart,&#10;                                MultipartBody.Part licenseFrontPart,&#10;                                MultipartBody.Part licenseBackPart) {&#10;        btnSubmit.setEnabled(false);&#10;        btnSubmit.setText(&quot;Đang tải lên...&quot;);&#10;&#10;        RequestBody nameRb = RequestBody.create(MediaType.parse(&quot;text/plain&quot;), enteredName);&#10;        RequestBody phone = RequestBody.create(MediaType.parse(&quot;text/plain&quot;), (currentUser != null &amp;&amp; currentUser.getPhone() != null) ? currentUser.getPhone() : &quot;&quot;);&#10;        RequestBody gender = RequestBody.create(MediaType.parse(&quot;text/plain&quot;), (currentUser != null &amp;&amp; currentUser.getGender() != null) ? currentUser.getGender() : &quot;&quot;);&#10;        MultipartBody.Part namePart = MultipartBody.Part.createFormData(&quot;name&quot;, null, nameRb);&#10;&#10;        Call&lt;ApiResponse&lt;User&gt;&gt; call = userApiService.updateProfile(&#10;                &quot;Bearer &quot; + token,&#10;                namePart,&#10;                phone,&#10;                gender,&#10;                null,&#10;                licenseFrontPart,&#10;                licenseBackPart,&#10;                idFrontPart,&#10;                idBackPart&#10;        );&#10;&#10;        call.enqueue(new Callback&lt;ApiResponse&lt;User&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;ApiResponse&lt;User&gt;&gt; call, Response&lt;ApiResponse&lt;User&gt;&gt; response) {&#10;                btnSubmit.setEnabled(true);&#10;                btnSubmit.setText(&quot;Gửi xác minh&quot;);&#10;&#10;                Log.d(TAG, &quot;submitWithName Response code: &quot; + response.code());&#10;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null &amp;&amp; response.body().isSuccess()) {&#10;                    User updatedUser = response.body().getData();&#10;                    if (updatedUser != null) {&#10;                        sessionManager.createLoginSession(updatedUser, token);&#10;                        updateStatusFromSession();&#10;                        Log.d(TAG, &quot;User updated with name. KYC: &quot; + updatedUser.getVerificationStatus());&#10;                    }&#10;                    Toast.makeText(VerifyAccountActivity.this, &quot;Đã gửi yêu cầu xác minh thành công!&quot;, Toast.LENGTH_LONG).show();&#10;                } else {&#10;                    String err = &quot;Không thể gửi. Code: &quot; + response.code();&#10;                    try {&#10;                        if (response.errorBody() != null) {&#10;                            String errBody = response.errorBody().string();&#10;                            Log.e(TAG, &quot;submitWithName error body: &quot; + errBody);&#10;                            err += &quot;\n&quot; + errBody;&#10;                        }&#10;                    } catch (Exception ex) {&#10;                        Log.w(TAG, &quot;Error reading errorBody&quot;, ex);&#10;                    }&#10;                    Toast.makeText(VerifyAccountActivity.this, err, Toast.LENGTH_LONG).show();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;ApiResponse&lt;User&gt;&gt; call, Throwable t) {&#10;                btnSubmit.setEnabled(true);&#10;                btnSubmit.setText(&quot;Gửi xác minh&quot;);&#10;                Log.e(TAG, &quot;submitWithName failure: &quot; + t.getClass().getSimpleName() + &quot; - &quot; + t.getMessage(), t);&#10;&#10;                String errorMsg = &quot;Lỗi: &quot;;&#10;                if (t instanceof java.net.SocketTimeoutException) {&#10;                    errorMsg += &quot;Timeout - thử lại hoặc dùng ảnh nhỏ hơn&quot;;&#10;                } else if (t instanceof java.net.UnknownHostException) {&#10;                    errorMsg += &quot;Không có kết nối internet&quot;;&#10;                } else {&#10;                    errorMsg += t.getMessage();&#10;                }&#10;&#10;                Toast.makeText(VerifyAccountActivity.this, errorMsg, Toast.LENGTH_LONG).show();&#10;            }&#10;        });&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.prm_project.activies;&#10;&#10;import android.Manifest;&#10;import android.app.AlertDialog;&#10;import android.content.Intent;&#10;import android.content.pm.PackageManager;&#10;import android.graphics.Bitmap;&#10;import android.graphics.BitmapFactory;&#10;import android.net.Uri;&#10;import android.os.Build;&#10;import android.os.Bundle;&#10;import android.provider.MediaStore;&#10;import android.util.Log;&#10;import android.view.View;&#10;import android.widget.EditText;&#10;import android.widget.FrameLayout;&#10;import android.widget.ImageButton;&#10;import android.widget.ImageView;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;&#10;import androidx.activity.result.ActivityResultLauncher;&#10;import androidx.activity.result.contract.ActivityResultContracts;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.core.app.ActivityCompat;&#10;import androidx.core.content.ContextCompat;&#10;&#10;import com.example.prm_project.R;&#10;import com.example.prm_project.api.ApiClient;&#10;import com.example.prm_project.api.UserApiService;&#10;import com.example.prm_project.models.ApiResponse;&#10;import com.example.prm_project.models.User;&#10;import com.example.prm_project.utils.SessionManager;&#10;import com.google.android.material.button.MaterialButton;&#10;&#10;import java.io.File;&#10;import java.io.FileOutputStream;&#10;import java.io.InputStream;&#10;import java.util.concurrent.ExecutorService;&#10;import java.util.concurrent.Executors;&#10;&#10;import okhttp3.MediaType;&#10;import okhttp3.MultipartBody;&#10;import okhttp3.RequestBody;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;public class VerifyAccountActivity extends AppCompatActivity {&#10;&#10;    private static final String TAG = &quot;VerifyAccount&quot;;&#10;    private static final int PERMISSION_REQUEST_CODE = 1001;&#10;&#10;    private ImageButton btnBack;&#10;    private FrameLayout layoutIdFront, layoutIdBack, layoutLicenseFront, layoutLicenseBack;&#10;    private ImageView ivIdFront, ivIdBack, ivLicenseFront, ivLicenseBack;&#10;    private View placeholderIdFront, placeholderIdBack, placeholderLicenseFront, placeholderLicenseBack;&#10;    private MaterialButton btnSubmit;&#10;    private TextView tvKycStatus;&#10;&#10;    private Uri idFrontUri, idBackUri, licenseFrontUri, licenseBackUri;&#10;    private int currentImageType = 0; // 1: ID Front, 2: ID Back, 3: License Front, 4: License Back&#10;&#10;    private ActivityResultLauncher&lt;Intent&gt; imagePickerLauncher;&#10;    private UserApiService userApiService;&#10;    private SessionManager sessionManager;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_verify_account);&#10;&#10;        initViews();&#10;&#10;        // Initialize session manager and API&#10;        sessionManager = new SessionManager(this);&#10;        userApiService = ApiClient.getClient().create(UserApiService.class);&#10;&#10;        // Request runtime permission early so user can pick images&#10;        checkAndRequestStoragePermission();&#10;&#10;        setupImagePicker();&#10;        setupListeners();&#10;&#10;        // Update UI according to current verification status&#10;        updateStatusFromSession();&#10;    }&#10;&#10;    private void initViews() {&#10;        btnBack = findViewById(R.id.btnBack);&#10;        layoutIdFront = findViewById(R.id.layoutIdFront);&#10;        layoutIdBack = findViewById(R.id.layoutIdBack);&#10;        layoutLicenseFront = findViewById(R.id.layoutLicenseFront);&#10;        layoutLicenseBack = findViewById(R.id.layoutLicenseBack);&#10;        btnSubmit = findViewById(R.id.btnSubmit);&#10;        tvKycStatus = findViewById(R.id.tvKycStatus);&#10;&#10;        // ImageViews for preview&#10;        ivIdFront = findViewById(R.id.ivIdFront);&#10;        ivIdBack = findViewById(R.id.ivIdBack);&#10;        ivLicenseFront = findViewById(R.id.ivLicenseFront);&#10;        ivLicenseBack = findViewById(R.id.ivLicenseBack);&#10;&#10;        // Placeholders&#10;        placeholderIdFront = findViewById(R.id.layoutIdFrontPlaceholder);&#10;        placeholderIdBack = findViewById(R.id.layoutIdBackPlaceholder);&#10;        placeholderLicenseFront = findViewById(R.id.layoutLicenseFrontPlaceholder);&#10;        placeholderLicenseBack = findViewById(R.id.layoutLicenseBackPlaceholder);&#10;    }&#10;&#10;    private void setupImagePicker() {&#10;        imagePickerLauncher = registerForActivityResult(&#10;            new ActivityResultContracts.StartActivityForResult(),&#10;            result -&gt; {&#10;                if (result.getResultCode() == RESULT_OK &amp;&amp; result.getData() != null) {&#10;                    Uri selectedImageUri = result.getData().getData();&#10;&#10;                    if (selectedImageUri == null) {&#10;                        Toast.makeText(this, &quot;Không thể lấy ảnh đã chọn&quot;, Toast.LENGTH_SHORT).show();&#10;                        return;&#10;                    }&#10;&#10;                    switch (currentImageType) {&#10;                        case 1:&#10;                            idFrontUri = selectedImageUri;&#10;                            showImagePreview(ivIdFront, placeholderIdFront, selectedImageUri);&#10;                            Toast.makeText(this, &quot;Đã chọn ảnh CMND/CCCD mặt trước&quot;, Toast.LENGTH_SHORT).show();&#10;                            break;&#10;                        case 2:&#10;                            idBackUri = selectedImageUri;&#10;                            showImagePreview(ivIdBack, placeholderIdBack, selectedImageUri);&#10;                            Toast.makeText(this, &quot;Đã chọn ảnh CMND/CCCD mặt sau&quot;, Toast.LENGTH_SHORT).show();&#10;                            break;&#10;                        case 3:&#10;                            licenseFrontUri = selectedImageUri;&#10;                            showImagePreview(ivLicenseFront, placeholderLicenseFront, selectedImageUri);&#10;                            Toast.makeText(this, &quot;Đã chọn ảnh giấy phép lái xe mặt trước&quot;, Toast.LENGTH_SHORT).show();&#10;                            break;&#10;                        case 4:&#10;                            licenseBackUri = selectedImageUri;&#10;                            showImagePreview(ivLicenseBack, placeholderLicenseBack, selectedImageUri);&#10;                            Toast.makeText(this, &quot;Đã chọn ảnh giấy phép lái xe mặt sau&quot;, Toast.LENGTH_SHORT).show();&#10;                            break;&#10;                    }&#10;&#10;                    checkAllUploaded();&#10;                }&#10;            }&#10;        );&#10;    }&#10;&#10;    private void showImagePreview(ImageView imageView, View placeholder, Uri imageUri) {&#10;        // Set image URI and show image view&#10;        imageView.setImageURI(imageUri);&#10;        imageView.setVisibility(View.VISIBLE);&#10;        placeholder.setVisibility(View.GONE);&#10;    }&#10;&#10;    private void setupListeners() {&#10;        btnBack.setOnClickListener(v -&gt; finish());&#10;&#10;        // Upload listeners - open image picker&#10;        layoutIdFront.setOnClickListener(v -&gt; {&#10;            currentImageType = 1;&#10;            openImagePicker();&#10;        });&#10;&#10;        layoutIdBack.setOnClickListener(v -&gt; {&#10;            currentImageType = 2;&#10;            openImagePicker();&#10;        });&#10;&#10;        layoutLicenseFront.setOnClickListener(v -&gt; {&#10;            currentImageType = 3;&#10;            openImagePicker();&#10;        });&#10;&#10;        layoutLicenseBack.setOnClickListener(v -&gt; {&#10;            currentImageType = 4;&#10;            openImagePicker();&#10;        });&#10;&#10;        btnSubmit.setOnClickListener(v -&gt; {&#10;            if (idFrontUri == null || idBackUri == null || licenseFrontUri == null || licenseBackUri == null) {&#10;                Toast.makeText(this, &quot;Vui lòng chọn đầy đủ ảnh giấy tờ&quot;, Toast.LENGTH_SHORT).show();&#10;                return;&#10;            }&#10;&#10;            uploadKYCDocuments();&#10;        });&#10;    }&#10;&#10;    private void openImagePicker() {&#10;        Intent intent = new Intent(Intent.ACTION_PICK, MediaStore.Images.Media.EXTERNAL_CONTENT_URI);&#10;        imagePickerLauncher.launch(intent);&#10;    }&#10;&#10;    private void checkAllUploaded() {&#10;        if (idFrontUri != null &amp;&amp; idBackUri != null &amp;&amp; licenseFrontUri != null &amp;&amp; licenseBackUri != null) {&#10;            btnSubmit.setEnabled(true);&#10;            btnSubmit.setBackgroundTintList(getResources().getColorStateList(R.color.primary_green, null));&#10;        }&#10;    }&#10;&#10;    private void uploadKYCDocuments() {&#10;        // Show loading&#10;        btnSubmit.setEnabled(false);&#10;        btnSubmit.setText(&quot;Đang chuẩn bị...&quot;);&#10;&#10;        // Get token from SessionManager&#10;        String token = sessionManager.getToken();&#10;        Log.d(TAG, &quot;Token: &quot; + token);&#10;        if (token == null || token.isEmpty()) {&#10;            Toast.makeText(this, &quot;Vui lòng đăng nhập lại&quot;, Toast.LENGTH_SHORT).show();&#10;            finish();&#10;            return;&#10;        }&#10;&#10;        // Move heavy image processing to background thread&#10;        ExecutorService executor = Executors.newSingleThreadExecutor();&#10;        executor.execute(() -&gt; {&#10;            try {&#10;                // Convert URIs to MultipartBody.Part in background thread&#10;                MultipartBody.Part idFrontPart = prepareFilePart(&quot;kyc.idFrontImage&quot;, idFrontUri);&#10;                MultipartBody.Part idBackPart = prepareFilePart(&quot;kyc.idBackImage&quot;, idBackUri);&#10;                MultipartBody.Part licenseFrontPart = prepareFilePart(&quot;kyc.licenseFrontImage&quot;, licenseFrontUri);&#10;                MultipartBody.Part licenseBackPart = prepareFilePart(&quot;kyc.licenseBackImage&quot;, licenseBackUri);&#10;&#10;                Log.d(TAG, &quot;Files prepared: &quot; + (idFrontPart != null) + &quot;, &quot; + (idBackPart != null) + &quot;, &quot; + (licenseFrontPart != null) + &quot;, &quot; + (licenseBackPart != null));&#10;&#10;                // Return to main thread to check results and call API&#10;                runOnUiThread(() -&gt; {&#10;                    if (idFrontPart == null || idBackPart == null || licenseFrontPart == null || licenseBackPart == null) {&#10;                        Toast.makeText(this, &quot;Lỗi khi chuẩn bị file, vui lòng thử lại&quot;, Toast.LENGTH_SHORT).show();&#10;                        btnSubmit.setEnabled(true);&#10;                        btnSubmit.setText(&quot;Gửi xác minh&quot;);&#10;                        return;&#10;                    }&#10;&#10;                    btnSubmit.setText(&quot;Đang tải lên...&quot;);&#10;&#10;                    // Get current user from session&#10;                    User currentUser = sessionManager.getUserDetails();&#10;                    String userName = (currentUser != null &amp;&amp; currentUser.getName() != null) ? currentUser.getName().trim() : &quot;&quot;;&#10;&#10;                    if (userName.isEmpty()) {&#10;                        // Backend requires 'name' field — ask user to update profile&#10;                        EditText input = new EditText(VerifyAccountActivity.this);&#10;                        input.setHint(&quot;Họ và tên&quot;);&#10;                        new AlertDialog.Builder(VerifyAccountActivity.this)&#10;                                .setTitle(&quot;Tên bắt buộc&quot;)&#10;                                .setMessage(&quot;Backend yêu cầu trường tên. Vui lòng nhập tên để tiếp tục gửi xác minh.&quot;)&#10;                                .setView(input)&#10;                                .setPositiveButton(&quot;Gửi&quot;, (dialog, which) -&gt; {&#10;                                    String entered = input.getText() != null ? input.getText().toString().trim() : &quot;&quot;;&#10;                                    if (entered.isEmpty()) {&#10;                                        Toast.makeText(VerifyAccountActivity.this, &quot;Tên không được để trống&quot;, Toast.LENGTH_SHORT).show();&#10;                                        btnSubmit.setEnabled(true);&#10;                                        btnSubmit.setText(&quot;Gửi xác minh&quot;);&#10;                                        return;&#10;                                    }&#10;                                    submitWithName(entered, currentUser, token, idFrontPart, idBackPart, licenseFrontPart, licenseBackPart);&#10;                                })&#10;                                .setNegativeButton(&quot;Hủy&quot;, (dialog, which) -&gt; {&#10;                                    btnSubmit.setEnabled(true);&#10;                                    btnSubmit.setText(&quot;Gửi xác minh&quot;);&#10;                                    dialog.dismiss();&#10;                                })&#10;                                .setCancelable(false)&#10;                                .show();&#10;                        return;&#10;                    }&#10;&#10;                    // Create multipart text part for name&#10;                    MultipartBody.Part namePart = MultipartBody.Part.createFormData(&quot;name&quot;, null, RequestBody.create(MediaType.parse(&quot;text/plain&quot;), userName));&#10;                    RequestBody phone = RequestBody.create(MediaType.parse(&quot;text/plain&quot;), (currentUser != null &amp;&amp; currentUser.getPhone() != null) ? currentUser.getPhone() : &quot;&quot;);&#10;                    RequestBody gender = RequestBody.create(MediaType.parse(&quot;text/plain&quot;), (currentUser != null &amp;&amp; currentUser.getGender() != null) ? currentUser.getGender() : &quot;&quot;);&#10;&#10;                    // Call API&#10;                    Call&lt;ApiResponse&lt;User&gt;&gt; call = userApiService.updateProfile(&#10;                        &quot;Bearer &quot; + token,&#10;                        namePart,&#10;                        phone,&#10;                        gender,&#10;                        null,&#10;                        licenseFrontPart,&#10;                        licenseBackPart,&#10;                        idFrontPart,&#10;                        idBackPart&#10;                    );&#10;&#10;                    call.enqueue(new Callback&lt;ApiResponse&lt;User&gt;&gt;() {&#10;                        @Override&#10;                        public void onResponse(Call&lt;ApiResponse&lt;User&gt;&gt; call, Response&lt;ApiResponse&lt;User&gt;&gt; response) {&#10;                            btnSubmit.setEnabled(true);&#10;                            btnSubmit.setText(&quot;Gửi xác minh&quot;);&#10;&#10;                            Log.d(TAG, &quot;Response code: &quot; + response.code());&#10;&#10;                            if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                                ApiResponse&lt;User&gt; apiResponse = response.body();&#10;                                Log.d(TAG, &quot;Response success: &quot; + apiResponse.isSuccess() + &quot;, message: &quot; + apiResponse.getMessage());&#10;                                if (apiResponse.isSuccess()) {&#10;                                    User updatedUser = apiResponse.getData();&#10;&#10;                                    if (updatedUser != null) {&#10;                                        sessionManager.createLoginSession(updatedUser, token);&#10;                                        Log.d(TAG, &quot;Updated user saved to session. KYC status: &quot; + updatedUser.getVerificationStatus());&#10;                                    }&#10;&#10;                                    updateStatusFromSession();&#10;&#10;                                    Toast.makeText(VerifyAccountActivity.this,&#10;                                        &quot;Đã gửi yêu cầu xác minh thành công!&quot;,&#10;                                        Toast.LENGTH_LONG).show();&#10;                                } else {&#10;                                    Log.e(TAG, &quot;API returned success=false: &quot; + apiResponse.getMessage());&#10;                                    Toast.makeText(VerifyAccountActivity.this,&#10;                                        &quot;Lỗi: &quot; + apiResponse.getMessage(),&#10;                                        Toast.LENGTH_SHORT).show();&#10;                                }&#10;                            } else {&#10;                                String err = &quot;Không thể kết nối server. Code: &quot; + response.code();&#10;                                try {&#10;                                    if (response.errorBody() != null) {&#10;                                        String errBody = response.errorBody().string();&#10;                                        Log.e(TAG, &quot;Error body: &quot; + errBody);&#10;                                        err += &quot;\n&quot; + errBody;&#10;                                    }&#10;                                } catch (Exception ex) {&#10;                                    Log.w(TAG, &quot;Error reading errorBody&quot;, ex);&#10;                                }&#10;                                Toast.makeText(VerifyAccountActivity.this, err, Toast.LENGTH_LONG).show();&#10;                            }&#10;                        }&#10;&#10;                        @Override&#10;                        public void onFailure(Call&lt;ApiResponse&lt;User&gt;&gt; call, Throwable t) {&#10;                            btnSubmit.setEnabled(true);&#10;                            btnSubmit.setText(&quot;Gửi xác minh&quot;);&#10;                            Log.e(TAG, &quot;Upload failure: &quot; + t.getClass().getSimpleName() + &quot; - &quot; + t.getMessage(), t);&#10;&#10;                            String errorMsg = &quot;Lỗi kết nối: &quot;;&#10;                            if (t instanceof java.net.SocketTimeoutException) {&#10;                                errorMsg += &quot;Timeout - kiểm tra kết nối mạng hoặc thử ảnh nhỏ hơn&quot;;&#10;                            } else if (t instanceof java.net.UnknownHostException) {&#10;                                errorMsg += &quot;Không thể kết nối server - kiểm tra internet&quot;;&#10;                            } else {&#10;                                errorMsg += t.getMessage();&#10;                            }&#10;&#10;                            Toast.makeText(VerifyAccountActivity.this, errorMsg, Toast.LENGTH_LONG).show();&#10;                        }&#10;                    });&#10;                });&#10;&#10;            } catch (Exception e) {&#10;                Log.e(TAG, &quot;Exception in background thread&quot;, e);&#10;                runOnUiThread(() -&gt; {&#10;                    btnSubmit.setEnabled(true);&#10;                    btnSubmit.setText(&quot;Gửi xác minh&quot;);&#10;                    Toast.makeText(this, &quot;Lỗi: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                });&#10;            } finally {&#10;                executor.shutdown();&#10;            }&#10;        });&#10;    }&#10;&#10;    private MultipartBody.Part prepareFilePart(String partName, Uri fileUri) {&#10;        try {&#10;            if (fileUri == null) return null;&#10;&#10;            // Create a temporary file&#10;            File file = new File(getCacheDir(), &quot;upload_&quot; + System.currentTimeMillis() + &quot;.jpg&quot;);&#10;&#10;            // Copy and COMPRESS content from Uri to file&#10;            InputStream inputStream = getContentResolver().openInputStream(fileUri);&#10;            if (inputStream == null) {&#10;                Log.w(TAG, &quot;Input stream is null for uri: &quot; + fileUri);&#10;                return null;&#10;            }&#10;&#10;            // Decode and compress bitmap to reduce file size&#10;            Bitmap bitmap = BitmapFactory.decodeStream(inputStream);&#10;            inputStream.close();&#10;&#10;            if (bitmap == null) {&#10;                Log.w(TAG, &quot;Failed to decode bitmap from uri: &quot; + fileUri);&#10;                return null;&#10;            }&#10;&#10;            // Compress to JPEG with quality 70% to reduce size significantly&#10;            FileOutputStream outputStream = new FileOutputStream(file);&#10;            bitmap.compress(Bitmap.CompressFormat.JPEG, 70, outputStream);&#10;            outputStream.close();&#10;            bitmap.recycle();&#10;&#10;            Log.d(TAG, &quot;Compressed file &quot; + partName + &quot;: &quot; + file.length() + &quot; bytes&quot;);&#10;&#10;            // Create RequestBody&#10;            RequestBody requestFile = RequestBody.create(&#10;                MediaType.parse(&quot;image/jpeg&quot;),&#10;                file&#10;            );&#10;&#10;            return MultipartBody.Part.createFormData(partName, file.getName(), requestFile);&#10;&#10;        } catch (Exception e) {&#10;            Log.e(TAG, &quot;prepareFilePart error for &quot; + partName, e);&#10;            return null;&#10;        }&#10;    }&#10;&#10;    private void checkAndRequestStoragePermission() {&#10;        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.TIRAMISU) {&#10;            // Android 13+: READ_MEDIA_IMAGES&#10;            if (ContextCompat.checkSelfPermission(this, Manifest.permission.READ_MEDIA_IMAGES) != PackageManager.PERMISSION_GRANTED) {&#10;                ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.READ_MEDIA_IMAGES}, PERMISSION_REQUEST_CODE);&#10;            }&#10;        } else {&#10;            // Older versions: READ_EXTERNAL_STORAGE&#10;            if (ContextCompat.checkSelfPermission(this, Manifest.permission.READ_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED) {&#10;                ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.READ_EXTERNAL_STORAGE}, PERMISSION_REQUEST_CODE);&#10;            }&#10;        }&#10;    }&#10;&#10;    @Override&#10;    public void onRequestPermissionsResult(int requestCode, String[] permissions, int[] grantResults) {&#10;        super.onRequestPermissionsResult(requestCode, permissions, grantResults);&#10;        if (requestCode == PERMISSION_REQUEST_CODE) {&#10;            if (grantResults.length &gt; 0 &amp;&amp; grantResults[0] == PackageManager.PERMISSION_GRANTED) {&#10;                Toast.makeText(this, &quot;Đã cấp quyền truy cập ảnh&quot;, Toast.LENGTH_SHORT).show();&#10;            } else {&#10;                Toast.makeText(this, &quot;Cần cấp quyền để chọn ảnh&quot;, Toast.LENGTH_SHORT).show();&#10;            }&#10;        }&#10;    }&#10;&#10;    private void updateStatusFromSession() {&#10;        if (sessionManager == null) return;&#10;        String kycStatus = sessionManager.getKycStatus();&#10;        boolean verified = sessionManager.isVerified();&#10;&#10;        String statusText = &quot;Trạng thái: &quot;;&#10;        if (verified) {&#10;            statusText += &quot;✅ Đã xác minh&quot;;&#10;            tvKycStatus.setTextColor(getResources().getColor(android.R.color.holo_green_dark, null));&#10;            disableInputsForStatus();&#10;        } else if (kycStatus != null &amp;&amp; kycStatus.equalsIgnoreCase(&quot;pending&quot;)) {&#10;            statusText += &quot;⏳ Đang chờ xác minh&quot;;&#10;            tvKycStatus.setTextColor(getResources().getColor(android.R.color.holo_orange_dark, null));&#10;            disableInputsForStatus();&#10;        } else {&#10;            statusText += &quot;⚠️ Chưa gửi&quot;;&#10;            tvKycStatus.setTextColor(getResources().getColor(android.R.color.darker_gray, null));&#10;            enableInputsForEditing();&#10;        }&#10;&#10;        tvKycStatus.setText(statusText);&#10;        Log.d(TAG, &quot;Status updated: verified=&quot; + verified + &quot;, kycStatus=&quot; + kycStatus);&#10;    }&#10;&#10;    private void disableInputsForStatus() {&#10;        layoutIdFront.setClickable(false);&#10;        layoutIdBack.setClickable(false);&#10;        layoutLicenseFront.setClickable(false);&#10;        layoutLicenseBack.setClickable(false);&#10;        btnSubmit.setEnabled(false);&#10;    }&#10;&#10;    private void enableInputsForEditing() {&#10;        layoutIdFront.setClickable(true);&#10;        layoutIdBack.setClickable(true);&#10;        layoutLicenseFront.setClickable(true);&#10;        layoutLicenseBack.setClickable(true);&#10;        // btnSubmit will be enabled only after all images selected&#10;        checkAllUploaded();&#10;    }&#10;&#10;    @Override&#10;    protected void onResume() {&#10;        super.onResume();&#10;        // Refresh profile from backend to get latest KYC status when user returns&#10;        refreshProfileFromApi();&#10;    }&#10;&#10;    private void refreshProfileFromApi() {&#10;        if (sessionManager == null || userApiService == null) return;&#10;        String token = sessionManager.getToken();&#10;        if (token == null || token.isEmpty()) return;&#10;&#10;        Call&lt;ApiResponse&lt;User&gt;&gt; call = userApiService.getUserProfile(&quot;Bearer &quot; + token);&#10;        call.enqueue(new Callback&lt;ApiResponse&lt;User&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;ApiResponse&lt;User&gt;&gt; call, Response&lt;ApiResponse&lt;User&gt;&gt; response) {&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null &amp;&amp; response.body().isSuccess()) {&#10;                    User user = response.body().getData();&#10;                    if (user != null) {&#10;                        // Persist the latest user (including kyc/isVerified)&#10;                        sessionManager.createLoginSession(user, token);&#10;                        // Update UI&#10;                        updateStatusFromSession();&#10;                        Log.d(TAG, &quot;Profile refreshed, kyc=&quot; + user.getVerificationStatus());&#10;                    }&#10;                } else {&#10;                    Log.w(TAG, &quot;refreshProfileFromApi failed: code=&quot; + response.code());&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;ApiResponse&lt;User&gt;&gt; call, Throwable t) {&#10;                Log.w(TAG, &quot;refreshProfileFromApi onFailure&quot;, t);&#10;            }&#10;        });&#10;    }&#10;&#10;    // Helper to submit when name was entered by user in dialog&#10;    private void submitWithName(String enteredName, User currentUser, String token,&#10;                                MultipartBody.Part idFrontPart,&#10;                                MultipartBody.Part idBackPart,&#10;                                MultipartBody.Part licenseFrontPart,&#10;                                MultipartBody.Part licenseBackPart) {&#10;        btnSubmit.setEnabled(false);&#10;        btnSubmit.setText(&quot;Đang tải lên...&quot;);&#10;&#10;        RequestBody nameRb = RequestBody.create(MediaType.parse(&quot;text/plain&quot;), enteredName);&#10;        RequestBody phone = RequestBody.create(MediaType.parse(&quot;text/plain&quot;), (currentUser != null &amp;&amp; currentUser.getPhone() != null) ? currentUser.getPhone() : &quot;&quot;);&#10;        RequestBody gender = RequestBody.create(MediaType.parse(&quot;text/plain&quot;), (currentUser != null &amp;&amp; currentUser.getGender() != null) ? currentUser.getGender() : &quot;&quot;);&#10;        MultipartBody.Part namePart = MultipartBody.Part.createFormData(&quot;name&quot;, null, nameRb);&#10;&#10;        Call&lt;ApiResponse&lt;User&gt;&gt; call = userApiService.updateProfile(&#10;                &quot;Bearer &quot; + token,&#10;                namePart,&#10;                phone,&#10;                gender,&#10;                null,&#10;                licenseFrontPart,&#10;                licenseBackPart,&#10;                idFrontPart,&#10;                idBackPart&#10;        );&#10;&#10;        call.enqueue(new Callback&lt;ApiResponse&lt;User&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;ApiResponse&lt;User&gt;&gt; call, Response&lt;ApiResponse&lt;User&gt;&gt; response) {&#10;                btnSubmit.setEnabled(true);&#10;                btnSubmit.setText(&quot;Gửi xác minh&quot;);&#10;&#10;                Log.d(TAG, &quot;submitWithName Response code: &quot; + response.code());&#10;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null &amp;&amp; response.body().isSuccess()) {&#10;                    User updatedUser = response.body().getData();&#10;                    if (updatedUser != null) {&#10;                        sessionManager.createLoginSession(updatedUser, token);&#10;                        updateStatusFromSession();&#10;                        Log.d(TAG, &quot;User updated with name. KYC: &quot; + updatedUser.getVerificationStatus());&#10;                    }&#10;                    Toast.makeText(VerifyAccountActivity.this, &quot;Đã gửi yêu cầu xác minh thành công!&quot;, Toast.LENGTH_LONG).show();&#10;                } else {&#10;                    String err = &quot;Không thể gửi. Code: &quot; + response.code();&#10;                    try {&#10;                        if (response.errorBody() != null) {&#10;                            String errBody = response.errorBody().string();&#10;                            Log.e(TAG, &quot;submitWithName error body: &quot; + errBody);&#10;                            err += &quot;\n&quot; + errBody;&#10;                        }&#10;                    } catch (Exception ex) {&#10;                        Log.w(TAG, &quot;Error reading errorBody&quot;, ex);&#10;                    }&#10;                    Toast.makeText(VerifyAccountActivity.this, err, Toast.LENGTH_LONG).show();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;ApiResponse&lt;User&gt;&gt; call, Throwable t) {&#10;                btnSubmit.setEnabled(true);&#10;                btnSubmit.setText(&quot;Gửi xác minh&quot;);&#10;                Log.e(TAG, &quot;submitWithName failure: &quot; + t.getClass().getSimpleName() + &quot; - &quot; + t.getMessage(), t);&#10;&#10;                String errorMsg = &quot;Lỗi: &quot;;&#10;                if (t instanceof java.net.SocketTimeoutException) {&#10;                    errorMsg += &quot;Timeout - thử lại hoặc dùng ảnh nhỏ hơn&quot;;&#10;                } else if (t instanceof java.net.UnknownHostException) {&#10;                    errorMsg += &quot;Không có kết nối internet&quot;;&#10;                } else {&#10;                    errorMsg += t.getMessage();&#10;                }&#10;&#10;                Toast.makeText(VerifyAccountActivity.this, errorMsg, Toast.LENGTH_LONG).show();&#10;            }&#10;        });&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/prm_project/adapters/BookingHistoryAdapter.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/prm_project/adapters/BookingHistoryAdapter.java" />
              <option name="originalContent" value="package com.example.prm_project.adapters;&#10;&#10;import android.view.LayoutInflater;&#10;import android.view.View;&#10;import android.view.ViewGroup;&#10;import android.widget.ImageView;&#10;import android.widget.TextView;&#10;&#10;import androidx.annotation.NonNull;&#10;import androidx.cardview.widget.CardView;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;&#10;import com.bumptech.glide.Glide;&#10;import com.example.prm_project.R;&#10;import com.example.prm_project.models.Booking;&#10;&#10;import java.text.NumberFormat;&#10;import java.text.SimpleDateFormat;&#10;import java.util.ArrayList;&#10;import java.util.Date;&#10;import java.util.List;&#10;import java.util.Locale;&#10;&#10;/**&#10; * Adapter for displaying booking history in RecyclerView&#10; */&#10;public class BookingHistoryAdapter extends RecyclerView.Adapter&lt;BookingHistoryAdapter.BookingViewHolder&gt; {&#10;&#10;    private List&lt;Booking&gt; bookingList;&#10;    private OnBookingClickListener listener;&#10;&#10;    public interface OnBookingClickListener {&#10;        void onBookingClick(Booking booking);&#10;    }&#10;&#10;    public BookingHistoryAdapter(OnBookingClickListener listener) {&#10;        this.bookingList = new ArrayList&lt;&gt;();&#10;        this.listener = listener;&#10;    }&#10;&#10;    public void setBookings(List&lt;Booking&gt; bookings) {&#10;        this.bookingList = bookings != null ? bookings : new ArrayList&lt;&gt;();&#10;        notifyDataSetChanged();&#10;    }&#10;&#10;    @NonNull&#10;    @Override&#10;    public BookingViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {&#10;        View view = LayoutInflater.from(parent.getContext())&#10;                .inflate(R.layout.item_booking, parent, false);&#10;        return new BookingViewHolder(view);&#10;    }&#10;&#10;    @Override&#10;    public void onBindViewHolder(@NonNull BookingViewHolder holder, int position) {&#10;        Booking booking = bookingList.get(position);&#10;        holder.bind(booking);&#10;    }&#10;&#10;    @Override&#10;    public int getItemCount() {&#10;        return bookingList.size();&#10;    }&#10;&#10;    class BookingViewHolder extends RecyclerView.ViewHolder {&#10;        private CardView cardView;&#10;        private ImageView ivVehicle;&#10;        private TextView tvVehicleName;&#10;        private TextView tvVehicleInfo;&#10;        private TextView tvDateRange;&#10;        private TextView tvTotalPrice;&#10;        private TextView tvStatus;&#10;&#10;        public BookingViewHolder(@NonNull View itemView) {&#10;            super(itemView);&#10;            cardView = itemView.findViewById(R.id.cardBooking);&#10;            ivVehicle = itemView.findViewById(R.id.ivVehicle);&#10;            tvVehicleName = itemView.findViewById(R.id.tvVehicleName);&#10;            tvVehicleInfo = itemView.findViewById(R.id.tvVehicleInfo);&#10;            tvDateRange = itemView.findViewById(R.id.tvDateRange);&#10;            tvTotalPrice = itemView.findViewById(R.id.tvTotalPrice);&#10;            tvStatus = itemView.findViewById(R.id.tvStatus);&#10;        }&#10;&#10;        public void bind(Booking booking) {&#10;            if (booking.getVehicle() != null) {&#10;                tvVehicleName.setText(booking.getVehicle().getName());&#10;&#10;                String info = booking.getVehicle().getBrand() + &quot; &quot; +&#10;                             booking.getVehicle().getModel() + &quot; • &quot; +&#10;                             booking.getVehicle().getYear();&#10;                tvVehicleInfo.setText(info);&#10;&#10;                // Load vehicle image&#10;                String imageUrl = booking.getVehicle().getFirstImageUrl();&#10;                if (imageUrl != null &amp;&amp; !imageUrl.isEmpty()) {&#10;                    Glide.with(itemView.getContext())&#10;                            .load(imageUrl)&#10;                            .placeholder(R.drawable.ic_car_placeholder)&#10;                            .error(R.drawable.ic_car_placeholder)&#10;                            .centerCrop()&#10;                            .into(ivVehicle);&#10;                } else {&#10;                    ivVehicle.setImageResource(R.drawable.ic_car_placeholder);&#10;                }&#10;            }&#10;&#10;            // Format date range&#10;            String dateRange = formatDate(booking.getStartDate()) + &quot; - &quot; + formatDate(booking.getEndDate());&#10;            tvDateRange.setText(dateRange);&#10;&#10;            // Format price&#10;            if (booking.getTotalPrice() != null) {&#10;                NumberFormat formatter = NumberFormat.getCurrencyInstance(new Locale(&quot;vi&quot;, &quot;VN&quot;));&#10;                tvTotalPrice.setText(formatter.format(booking.getTotalPrice()));&#10;            } else {&#10;                tvTotalPrice.setText(&quot;0 ₫&quot;);&#10;            }&#10;&#10;            // Set status&#10;            tvStatus.setText(booking.getStatusText());&#10;&#10;            // Set status color&#10;            int statusColor = getStatusColor(booking.getStatus());&#10;            tvStatus.setTextColor(itemView.getContext().getColor(statusColor));&#10;&#10;            // Set click listener&#10;            cardView.setOnClickListener(v -&gt; {&#10;                if (listener != null) {&#10;                    listener.onBookingClick(booking);&#10;                }&#10;            });&#10;        }&#10;&#10;        private String formatDate(String dateString) {&#10;            try {&#10;                SimpleDateFormat inputFormat = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ss.SSS'Z'&quot;, Locale.getDefault());&#10;                SimpleDateFormat outputFormat = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;, Locale.getDefault());&#10;                Date date = inputFormat.parse(dateString);&#10;                return outputFormat.format(date);&#10;            } catch (Exception e) {&#10;                return dateString;&#10;            }&#10;        }&#10;&#10;        private int getStatusColor(String status) {&#10;            if (status == null) return R.color.gray_500;&#10;            switch (status.toLowerCase()) {&#10;                case &quot;pending&quot;:&#10;                    return R.color.orange_500;&#10;                case &quot;approved&quot;:&#10;                    return R.color.primary_blue;&#10;                case &quot;rejected&quot;:&#10;                    return R.color.red_500;&#10;                case &quot;completed&quot;:&#10;                    return R.color.green_500;&#10;                case &quot;cancelled&quot;:&#10;                    return R.color.gray_500;&#10;                default:&#10;                    return R.color.gray_500;&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.example.prm_project.adapters;&#10;&#10;import android.view.LayoutInflater;&#10;import android.view.View;&#10;import android.view.ViewGroup;&#10;import android.widget.ImageView;&#10;import android.widget.TextView;&#10;&#10;import androidx.annotation.NonNull;&#10;import androidx.cardview.widget.CardView;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;&#10;import com.bumptech.glide.Glide;&#10;import com.example.prm_project.R;&#10;import com.example.prm_project.models.Booking;&#10;&#10;import java.text.NumberFormat;&#10;import java.text.SimpleDateFormat;&#10;import java.util.ArrayList;&#10;import java.util.Date;&#10;import java.util.List;&#10;import java.util.Locale;&#10;&#10;/**&#10; * Adapter for displaying booking history in RecyclerView&#10; */&#10;public class BookingHistoryAdapter extends RecyclerView.Adapter&lt;BookingHistoryAdapter.BookingViewHolder&gt; {&#10;&#10;    private List&lt;Booking&gt; bookingList;&#10;    private OnBookingClickListener listener;&#10;&#10;    public interface OnBookingClickListener {&#10;        void onBookingClick(Booking booking);&#10;    }&#10;&#10;    public BookingHistoryAdapter(OnBookingClickListener listener) {&#10;        this.bookingList = new ArrayList&lt;&gt;();&#10;        this.listener = listener;&#10;    }&#10;&#10;    public void setBookings(List&lt;Booking&gt; bookings) {&#10;        this.bookingList = bookings != null ? bookings : new ArrayList&lt;&gt;();&#10;        notifyDataSetChanged();&#10;    }&#10;&#10;    @NonNull&#10;    @Override&#10;    public BookingViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {&#10;        View view = LayoutInflater.from(parent.getContext())&#10;                .inflate(R.layout.item_booking_history, parent, false);&#10;        return new BookingViewHolder(view);&#10;    }&#10;&#10;    @Override&#10;    public void onBindViewHolder(@NonNull BookingViewHolder holder, int position) {&#10;        Booking booking = bookingList.get(position);&#10;        holder.bind(booking);&#10;    }&#10;&#10;    @Override&#10;    public int getItemCount() {&#10;        return bookingList.size();&#10;    }&#10;&#10;    class BookingViewHolder extends RecyclerView.ViewHolder {&#10;        private final CardView cardView;&#10;        private final ImageView ivVehicle;&#10;        private final TextView tvVehicleName;&#10;        private final TextView tvVehicleInfo;&#10;        private final TextView tvDateRange;&#10;        private final TextView tvTotalPrice;&#10;        private final TextView tvStatus;&#10;&#10;        public BookingViewHolder(@NonNull View itemView) {&#10;            super(itemView);&#10;            cardView = itemView.findViewById(R.id.cardBookingHistory);&#10;            ivVehicle = itemView.findViewById(R.id.ivVehicleHistory);&#10;            tvVehicleName = itemView.findViewById(R.id.tvVehicleNameHistory);&#10;            tvVehicleInfo = itemView.findViewById(R.id.tvVehicleInfoHistory);&#10;            tvDateRange = itemView.findViewById(R.id.tvDateRangeHistory);&#10;            tvTotalPrice = itemView.findViewById(R.id.tvTotalPriceHistory);&#10;            tvStatus = itemView.findViewById(R.id.tvStatusHistory);&#10;        }&#10;&#10;        public void bind(Booking booking) {&#10;            if (booking.getVehicle() != null) {&#10;                tvVehicleName.setText(booking.getVehicle().getName());&#10;&#10;                String info = booking.getVehicle().getBrand() + &quot; &quot; +&#10;                             booking.getVehicle().getModel() + &quot; • &quot; +&#10;                             booking.getVehicle().getYear();&#10;                tvVehicleInfo.setText(info);&#10;&#10;                // Load vehicle image&#10;                String imageUrl = booking.getVehicle().getFirstImageUrl();&#10;                if (imageUrl != null &amp;&amp; !imageUrl.isEmpty()) {&#10;                    Glide.with(itemView.getContext())&#10;                            .load(imageUrl)&#10;                            .placeholder(R.drawable.ic_car_placeholder)&#10;                            .error(R.drawable.ic_car_placeholder)&#10;                            .centerCrop()&#10;                            .into(ivVehicle);&#10;                } else {&#10;                    ivVehicle.setImageResource(R.drawable.ic_car_placeholder);&#10;                }&#10;            }&#10;&#10;            // Format date range&#10;            String dateRange = formatDate(booking.getStartDate()) + &quot; - &quot; + formatDate(booking.getEndDate());&#10;            tvDateRange.setText(dateRange);&#10;&#10;            // Format price&#10;            if (booking.getTotalPrice() != null) {&#10;                NumberFormat formatter = NumberFormat.getCurrencyInstance(new Locale(&quot;vi&quot;, &quot;VN&quot;));&#10;                tvTotalPrice.setText(formatter.format(booking.getTotalPrice()));&#10;            } else {&#10;                tvTotalPrice.setText(&quot;0 ₫&quot;);&#10;            }&#10;&#10;            // Set status&#10;            tvStatus.setText(booking.getStatusText());&#10;&#10;            // Set status color&#10;            int statusColor = getStatusColor(booking.getStatus());&#10;            tvStatus.setTextColor(itemView.getContext().getColor(statusColor));&#10;&#10;            // Set click listener&#10;            cardView.setOnClickListener(v -&gt; {&#10;                if (listener != null) {&#10;                    listener.onBookingClick(booking);&#10;                }&#10;            });&#10;        }&#10;&#10;        private String formatDate(String dateString) {&#10;            try {&#10;                SimpleDateFormat inputFormat = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ss.SSS'Z'&quot;, Locale.getDefault());&#10;                SimpleDateFormat outputFormat = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;, Locale.getDefault());&#10;                Date date = inputFormat.parse(dateString);&#10;                return outputFormat.format(date);&#10;            } catch (Exception e) {&#10;                return dateString;&#10;            }&#10;        }&#10;&#10;        private int getStatusColor(String status) {&#10;            if (status == null) return R.color.gray_500;&#10;            switch (status.toLowerCase()) {&#10;                case &quot;pending&quot;:&#10;                    return R.color.orange_500;&#10;                case &quot;approved&quot;:&#10;                    return R.color.primary_blue;&#10;                case &quot;rejected&quot;:&#10;                    return R.color.red_500;&#10;                case &quot;completed&quot;:&#10;                    return R.color.green_500;&#10;                case &quot;cancelled&quot;:&#10;                    return R.color.gray_500;&#10;                default:&#10;                    return R.color.gray_500;&#10;            }&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/prm_project/models/Booking.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/prm_project/models/Booking.java" />
              <option name="updatedContent" value="package com.example.prm_project.models;&#10;&#10;import com.google.gson.annotations.SerializedName;&#10;&#10;/**&#10; * Booking model representing rental booking data from API&#10; */&#10;public class Booking {&#10;&#10;    @SerializedName(&quot;_id&quot;)&#10;    private String id;&#10;&#10;    @SerializedName(&quot;vehicle&quot;)&#10;    private Vehicle vehicle;&#10;&#10;    @SerializedName(&quot;renter&quot;)&#10;    private String renter;&#10;&#10;    @SerializedName(&quot;startDate&quot;)&#10;    private String startDate;&#10;&#10;    @SerializedName(&quot;endDate&quot;)&#10;    private String endDate;&#10;&#10;    @SerializedName(&quot;totalPrice&quot;)&#10;    private Double totalPrice;&#10;&#10;    @SerializedName(&quot;status&quot;)&#10;    private String status; // &quot;pending&quot;, &quot;approved&quot;, &quot;rejected&quot;, &quot;completed&quot;, &quot;cancelled&quot;&#10;&#10;    @SerializedName(&quot;createdAt&quot;)&#10;    private String createdAt;&#10;&#10;    @SerializedName(&quot;updatedAt&quot;)&#10;    private String updatedAt;&#10;&#10;    // Nested Vehicle class&#10;    public static class Vehicle {&#10;        @SerializedName(&quot;_id&quot;)&#10;        private String id;&#10;&#10;        @SerializedName(&quot;name&quot;)&#10;        private String name;&#10;&#10;        @SerializedName(&quot;brand&quot;)&#10;        private String brand;&#10;&#10;        @SerializedName(&quot;model&quot;)&#10;        private String model;&#10;&#10;        @SerializedName(&quot;year&quot;)&#10;        private Integer year;&#10;&#10;        @SerializedName(&quot;pricePerDay&quot;)&#10;        private Double pricePerDay;&#10;&#10;        @SerializedName(&quot;images&quot;)&#10;        private ImageData[] images;&#10;&#10;        @SerializedName(&quot;licensePlate&quot;)&#10;        private String licensePlate;&#10;&#10;        public String getId() { return id; }&#10;        public void setId(String id) { this.id = id; }&#10;&#10;        public String getName() { return name; }&#10;        public void setName(String name) { this.name = name; }&#10;&#10;        public String getBrand() { return brand; }&#10;        public void setBrand(String brand) { this.brand = brand; }&#10;&#10;        public String getModel() { return model; }&#10;        public void setModel(String model) { this.model = model; }&#10;&#10;        public Integer getYear() { return year; }&#10;        public void setYear(Integer year) { this.year = year; }&#10;&#10;        public Double getPricePerDay() { return pricePerDay; }&#10;        public void setPricePerDay(Double pricePerDay) { this.pricePerDay = pricePerDay; }&#10;&#10;        public ImageData[] getImages() { return images; }&#10;        public void setImages(ImageData[] images) { this.images = images; }&#10;&#10;        public String getLicensePlate() { return licensePlate; }&#10;        public void setLicensePlate(String licensePlate) { this.licensePlate = licensePlate; }&#10;&#10;        public String getFirstImageUrl() {&#10;            if (images != null &amp;&amp; images.length &gt; 0 &amp;&amp; images[0] != null) {&#10;                return images[0].getUrl();&#10;            }&#10;            return null;&#10;        }&#10;    }&#10;&#10;    // Constructors&#10;    public Booking() {&#10;    }&#10;&#10;    // Getters and Setters&#10;    public String getId() {&#10;        return id;&#10;    }&#10;&#10;    public void setId(String id) {&#10;        this.id = id;&#10;    }&#10;&#10;    public Vehicle getVehicle() {&#10;        return vehicle;&#10;    }&#10;&#10;    public void setVehicle(Vehicle vehicle) {&#10;        this.vehicle = vehicle;&#10;    }&#10;&#10;    public String getRenter() {&#10;        return renter;&#10;    }&#10;&#10;    public void setRenter(String renter) {&#10;        this.renter = renter;&#10;    }&#10;&#10;    public String getStartDate() {&#10;        return startDate;&#10;    }&#10;&#10;    public void setStartDate(String startDate) {&#10;        this.startDate = startDate;&#10;    }&#10;&#10;    public String getEndDate() {&#10;        return endDate;&#10;    }&#10;&#10;    public void setEndDate(String endDate) {&#10;        this.endDate = endDate;&#10;    }&#10;&#10;    public Double getTotalPrice() {&#10;        return totalPrice;&#10;    }&#10;&#10;    public void setTotalPrice(Double totalPrice) {&#10;        this.totalPrice = totalPrice;&#10;    }&#10;&#10;    public String getStatus() {&#10;        return status;&#10;    }&#10;&#10;    public void setStatus(String status) {&#10;        this.status = status;&#10;    }&#10;&#10;    public String getCreatedAt() {&#10;        return createdAt;&#10;    }&#10;&#10;    public void setCreatedAt(String createdAt) {&#10;        this.createdAt = createdAt;&#10;    }&#10;&#10;    public String getUpdatedAt() {&#10;        return updatedAt;&#10;    }&#10;&#10;    public void setUpdatedAt(String updatedAt) {&#10;        this.updatedAt = updatedAt;&#10;    }&#10;&#10;    // Helper methods&#10;    public String getStatusText() {&#10;        if (status == null) return &quot;Không xác định&quot;;&#10;        switch (status.toLowerCase()) {&#10;            case &quot;pending&quot;:&#10;                return &quot;Chờ xác nhận&quot;;&#10;            case &quot;approved&quot;:&#10;                return &quot;Đã xác nhận&quot;;&#10;            case &quot;rejected&quot;:&#10;                return &quot;Đã từ chối&quot;;&#10;            case &quot;completed&quot;:&#10;                return &quot;Hoàn thành&quot;;&#10;            case &quot;cancelled&quot;:&#10;                return &quot;Đã hủy&quot;;&#10;            default:&#10;                return status;&#10;        }&#10;    }&#10;&#10;    @Override&#10;    public String toString() {&#10;        return &quot;Booking{&quot; +&#10;                &quot;id='&quot; + id + '\'' +&#10;                &quot;, vehicle=&quot; + (vehicle != null ? vehicle.getName() : &quot;null&quot;) +&#10;                &quot;, startDate='&quot; + startDate + '\'' +&#10;                &quot;, endDate='&quot; + endDate + '\'' +&#10;                &quot;, totalPrice=&quot; + totalPrice +&#10;                &quot;, status='&quot; + status + '\'' +&#10;                '}';&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/prm_project/models/ImageData.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/prm_project/models/ImageData.java" />
              <option name="updatedContent" value="package com.example.prm_project.models;&#10;&#10;import com.google.gson.annotations.SerializedName;&#10;&#10;/**&#10; * Model for image data returned from backend&#10; */&#10;public class ImageData {&#10;    &#10;    @SerializedName(&quot;url&quot;)&#10;    private String url;&#10;    &#10;    @SerializedName(&quot;publicId&quot;)&#10;    private String publicId;&#10;    &#10;    @SerializedName(&quot;_id&quot;)&#10;    private String id;&#10;    &#10;    public ImageData() {&#10;    }&#10;    &#10;    public ImageData(String url, String publicId) {&#10;        this.url = url;&#10;        this.publicId = publicId;&#10;    }&#10;    &#10;    public String getUrl() {&#10;        return url;&#10;    }&#10;    &#10;    public void setUrl(String url) {&#10;        this.url = url;&#10;    }&#10;    &#10;    public String getPublicId() {&#10;        return publicId;&#10;    }&#10;    &#10;    public void setPublicId(String publicId) {&#10;        this.publicId = publicId;&#10;    }&#10;    &#10;    public String getId() {&#10;        return id;&#10;    }&#10;    &#10;    public void setId(String id) {&#10;        this.id = id;&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/prm_project/ui/bookings/BookingHistoryFragment.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/prm_project/ui/bookings/BookingHistoryFragment.java" />
              <option name="updatedContent" value="package com.example.prm_project.ui.bookings;&#10;&#10;import android.os.Bundle;&#10;import android.util.Log;&#10;import android.view.LayoutInflater;&#10;import android.view.View;&#10;import android.view.ViewGroup;&#10;import android.widget.Toast;&#10;&#10;import androidx.annotation.NonNull;&#10;import androidx.fragment.app.Fragment;&#10;import androidx.navigation.fragment.NavHostFragment;&#10;import androidx.recyclerview.widget.LinearLayoutManager;&#10;&#10;import com.example.prm_project.R;&#10;import com.example.prm_project.adapters.BookingHistoryAdapter;&#10;import com.example.prm_project.api.ApiClient;&#10;import com.example.prm_project.api.BookingApiService;&#10;import com.example.prm_project.databinding.FragmentBookingHistoryBinding;&#10;import com.example.prm_project.models.ApiResponse;&#10;import com.example.prm_project.models.Booking;&#10;import com.example.prm_project.utils.SessionManager;&#10;&#10;import java.util.List;&#10;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;public class BookingHistoryFragment extends Fragment {&#10;&#10;    private static final String TAG = &quot;BookingHistoryFragment&quot;;&#10;    private FragmentBookingHistoryBinding binding;&#10;    private BookingHistoryAdapter adapter;&#10;    private SessionManager sessionManager;&#10;    private BookingApiService bookingApiService;&#10;&#10;    @Override&#10;    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {&#10;        binding = FragmentBookingHistoryBinding.inflate(inflater, container, false);&#10;        View root = binding.getRoot();&#10;&#10;        // Initialize&#10;        sessionManager = new SessionManager(requireContext());&#10;        bookingApiService = ApiClient.getClient().create(BookingApiService.class);&#10;&#10;        // Setup RecyclerView&#10;        setupRecyclerView();&#10;&#10;        // Back button&#10;        binding.btnBack.setOnClickListener(v -&gt;&#10;                NavHostFragment.findNavController(BookingHistoryFragment.this).popBackStack()&#10;        );&#10;&#10;        // Load bookings&#10;        loadBookings();&#10;&#10;        return root;&#10;    }&#10;&#10;    private void setupRecyclerView() {&#10;        adapter = new BookingHistoryAdapter(booking -&gt; {&#10;            // Handle booking item click&#10;            Toast.makeText(getContext(), &quot;Chi tiết: &quot; + booking.getVehicle().getName(), Toast.LENGTH_SHORT).show();&#10;            // TODO: Navigate to booking detail screen&#10;        });&#10;&#10;        binding.rvBookings.setLayoutManager(new LinearLayoutManager(getContext()));&#10;        binding.rvBookings.setAdapter(adapter);&#10;    }&#10;&#10;    private void loadBookings() {&#10;        String token = sessionManager.getToken();&#10;        if (token == null || token.isEmpty()) {&#10;            Log.e(TAG, &quot;No token found&quot;);&#10;            Toast.makeText(getContext(), &quot;Vui lòng đăng nhập lại&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        // Show loading&#10;        binding.progressBar.setVisibility(View.VISIBLE);&#10;        binding.rvBookings.setVisibility(View.GONE);&#10;        binding.emptyState.setVisibility(View.GONE);&#10;&#10;        String bearerToken = token.startsWith(&quot;Bearer &quot;) ? token : &quot;Bearer &quot; + token;&#10;&#10;        Log.d(TAG, &quot;Loading bookings...&quot;);&#10;&#10;        Call&lt;ApiResponse&lt;List&lt;Booking&gt;&gt;&gt; call = bookingApiService.getMyBookings(bearerToken);&#10;        call.enqueue(new Callback&lt;ApiResponse&lt;List&lt;Booking&gt;&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;ApiResponse&lt;List&lt;Booking&gt;&gt;&gt; call, Response&lt;ApiResponse&lt;List&lt;Booking&gt;&gt;&gt; response) {&#10;                binding.progressBar.setVisibility(View.GONE);&#10;&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    ApiResponse&lt;List&lt;Booking&gt;&gt; apiResponse = response.body();&#10;&#10;                    if (apiResponse.isSuccess() &amp;&amp; apiResponse.getData() != null) {&#10;                        List&lt;Booking&gt; bookings = apiResponse.getData();&#10;                        Log.d(TAG, &quot;Loaded &quot; + bookings.size() + &quot; bookings&quot;);&#10;&#10;                        if (bookings.isEmpty()) {&#10;                            // Show empty state&#10;                            binding.emptyState.setVisibility(View.VISIBLE);&#10;                            binding.rvBookings.setVisibility(View.GONE);&#10;                        } else {&#10;                            // Show bookings&#10;                            adapter.setBookings(bookings);&#10;                            binding.rvBookings.setVisibility(View.VISIBLE);&#10;                            binding.emptyState.setVisibility(View.GONE);&#10;                        }&#10;                    } else {&#10;                        Log.e(TAG, &quot;API returned error: &quot; + apiResponse.getMessage());&#10;                        showError(&quot;Không thể tải lịch sử thuê xe&quot;);&#10;                    }&#10;                } else {&#10;                    Log.e(TAG, &quot;API call failed: &quot; + response.code());&#10;                    showError(&quot;Lỗi server: &quot; + response.code());&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;ApiResponse&lt;List&lt;Booking&gt;&gt;&gt; call, Throwable t) {&#10;                binding.progressBar.setVisibility(View.GONE);&#10;                Log.e(TAG, &quot;Network error&quot;, t);&#10;                showError(&quot;Lỗi kết nối: &quot; + t.getMessage());&#10;            }&#10;        });&#10;    }&#10;&#10;    private void showError(String message) {&#10;        Toast.makeText(getContext(), message, Toast.LENGTH_LONG).show();&#10;        binding.emptyState.setVisibility(View.VISIBLE);&#10;        binding.rvBookings.setVisibility(View.GONE);&#10;    }&#10;&#10;    @Override&#10;    public void onDestroyView() {&#10;        super.onDestroyView();&#10;        binding = null;&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/prm_project/ui/profile/ProfileFragment.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/prm_project/ui/profile/ProfileFragment.java" />
              <option name="originalContent" value="package com.example.prm_project.ui.profile;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.util.Log;&#10;import android.view.LayoutInflater;&#10;import android.view.View;&#10;import android.view.ViewGroup;&#10;import android.widget.Button;&#10;import android.widget.ImageView;&#10;import android.widget.LinearLayout;&#10;import android.widget.ProgressBar;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;&#10;import androidx.annotation.NonNull;&#10;import androidx.fragment.app.Fragment;&#10;import androidx.lifecycle.ViewModelProvider;&#10;import androidx.navigation.fragment.NavHostFragment;&#10;&#10;import com.example.prm_project.R;&#10;import com.example.prm_project.activies.VerifyAccountActivity;&#10;import com.example.prm_project.databinding.FragmentProfileBinding;&#10;&#10;public class ProfileFragment extends Fragment {&#10;    private static final String TAG = &quot;ProfileFragment&quot;;&#10;    private FragmentProfileBinding binding;&#10;    private ProfileViewModel profileViewModel;&#10;&#10;    public View onCreateView(@NonNull LayoutInflater inflater,&#10;                             ViewGroup container, Bundle savedInstanceState) {&#10;        profileViewModel = new ViewModelProvider(requireActivity()).get(ProfileViewModel.class);&#10;        binding = FragmentProfileBinding.inflate(inflater, container, false);&#10;        View root = binding.getRoot();&#10;&#10;        Log.d(TAG, &quot;ProfileFragment onCreateView&quot;);&#10;&#10;        // Header: cập nhật tên, email&#10;        profileViewModel.getName().observe(getViewLifecycleOwner(), name -&gt; {&#10;            Log.d(TAG, &quot;Name changed in ViewModel: &quot; + name);&#10;            binding.tvName.setText(name);&#10;        });&#10;        profileViewModel.getEmail().observe(getViewLifecycleOwner(), email -&gt; {&#10;            Log.d(TAG, &quot;Email changed in ViewModel: &quot; + email);&#10;            binding.tvEmail.setText(email);&#10;        });&#10;&#10;        // Thống kê chuyến đi, quãng đường&#10;        profileViewModel.getRidesCount().observe(getViewLifecycleOwner(), count -&gt; binding.tvRidesCount.setText(String.valueOf(count)));&#10;        profileViewModel.getDistanceKm().observe(getViewLifecycleOwner(), d -&gt; binding.tvDistance.setText(d));&#10;&#10;        // Observe loading state&#10;        profileViewModel.getIsLoading().observe(getViewLifecycleOwner(), isLoading -&gt; {&#10;            if (isLoading != null &amp;&amp; isLoading) {&#10;                // Show loading indicator if you have one in layout&#10;                // binding.progressBar.setVisibility(View.VISIBLE);&#10;            } else {&#10;                // binding.progressBar.setVisibility(View.GONE);&#10;            }&#10;        });&#10;&#10;        // Observe error messages&#10;        profileViewModel.getErrorMessage().observe(getViewLifecycleOwner(), error -&gt; {&#10;            if (error != null &amp;&amp; !error.isEmpty()) {&#10;                Toast.makeText(getContext(), error, Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#10;&#10;        // Gán icon, tiêu đề, sự kiện cho từng mục menu&#10;        setupMenuItems(root);&#10;&#10;        // Sự kiện cho mục Cài Đặt (Chỉnh sửa hồ sơ)&#10;        LinearLayout llSettings = root.findViewById(R.id.llSettings);&#10;        if (llSettings != null) {&#10;            llSettings.setOnClickListener(v -&gt; {&#10;                NavHostFragment.findNavController(ProfileFragment.this)&#10;                        .navigate(R.id.navigation_edit_profile);&#10;            });&#10;        }&#10;&#10;        // Nút Đăng xuất&#10;        Button btnLogout = root.findViewById(R.id.btnLogout);&#10;        btnLogout.setOnClickListener(v -&gt; Toast.makeText(getContext(), &quot;Đăng xuất&quot;, Toast.LENGTH_SHORT).show());&#10;&#10;        return root;&#10;    }&#10;&#10;    private void setupMenuItems(View root) {&#10;        // Xác minh tài khoản&#10;        LinearLayout llVerify = root.findViewById(R.id.llVerify);&#10;        ((ImageView) llVerify.findViewById(R.id.ivMenuIcon)).setImageResource(R.drawable.ic_check_black_24dp);&#10;        ((TextView) llVerify.findViewById(R.id.tvMenuTitle)).setText(&quot;Xác minh tài khoản&quot;);&#10;        llVerify.setOnClickListener(v -&gt; {&#10;            Intent intent = new Intent(getActivity(), VerifyAccountActivity.class);&#10;            startActivity(intent);&#10;        });&#10;&#10;        // Lịch sử thuê xe&#10;        LinearLayout llHistory = root.findViewById(R.id.llHistory);&#10;        ((ImageView) llHistory.findViewById(R.id.ivMenuIcon)).setImageResource(R.drawable.ic_calendar_24dp);&#10;        ((TextView) llHistory.findViewById(R.id.tvMenuTitle)).setText(&quot;Lịch sử thuê xe&quot;);&#10;        llHistory.setOnClickListener(v -&gt; Toast.makeText(getContext(), &quot;Lịch sử thuê xe&quot;, Toast.LENGTH_SHORT).show());&#10;&#10;        // Cài đặt&#10;        LinearLayout llSettings = root.findViewById(R.id.llSettings);&#10;        ((ImageView) llSettings.findViewById(R.id.ivMenuIcon)).setImageResource(R.drawable.ic_settings);&#10;        ((TextView) llSettings.findViewById(R.id.tvMenuTitle)).setText(&quot;Cài đặt&quot;);&#10;        llSettings.setOnClickListener(v -&gt; NavHostFragment.findNavController(ProfileFragment.this)&#10;                .navigate(R.id.navigation_settings));&#10;&#10;        // Trợ giúp &amp; Hỗ trợ&#10;        LinearLayout llSupport = root.findViewById(R.id.llSupport);&#10;        ((ImageView) llSupport.findViewById(R.id.ivMenuIcon)).setImageResource(R.drawable.ic_search_24dp);&#10;        ((TextView) llSupport.findViewById(R.id.tvMenuTitle)).setText(&quot;Trợ giúp &amp; Hỗ trợ&quot;);&#10;        llSupport.setOnClickListener(v -&gt; Toast.makeText(getContext(), &quot;Trợ giúp &amp; Hỗ trợ&quot;, Toast.LENGTH_SHORT).show());&#10;&#10;        // Về chúng tôi&#10;        LinearLayout llAbout = root.findViewById(R.id.llAbout);&#10;        ((ImageView) llAbout.findViewById(R.id.ivMenuIcon)).setImageResource(R.drawable.ic_home_black_24dp);&#10;        ((TextView) llAbout.findViewById(R.id.tvMenuTitle)).setText(&quot;Về chúng tôi&quot;);&#10;        llAbout.setOnClickListener(v -&gt; Toast.makeText(getContext(), &quot;Về chúng tôi&quot;, Toast.LENGTH_SHORT).show());&#10;    }&#10;&#10;    @Override&#10;    public void onResume() {&#10;        super.onResume();&#10;        Log.d(TAG, &quot;ProfileFragment onResume - reloading profile&quot;);&#10;        // Reload profile data from API when fragment resumes&#10;        if (profileViewModel != null) {&#10;            profileViewModel.loadUserProfile();&#10;        }&#10;    }&#10;&#10;    @Override&#10;    public void onDestroyView() {&#10;        super.onDestroyView();&#10;        binding = null;&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.example.prm_project.ui.profile;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.util.Log;&#10;import android.view.LayoutInflater;&#10;import android.view.View;&#10;import android.view.ViewGroup;&#10;import android.widget.Button;&#10;import android.widget.ImageView;&#10;import android.widget.LinearLayout;&#10;import android.widget.ProgressBar;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;&#10;import androidx.annotation.NonNull;&#10;import androidx.fragment.app.Fragment;&#10;import androidx.lifecycle.ViewModelProvider;&#10;import androidx.navigation.fragment.NavHostFragment;&#10;&#10;import com.example.prm_project.R;&#10;import com.example.prm_project.activies.VerifyAccountActivity;&#10;import com.example.prm_project.databinding.FragmentProfileBinding;&#10;&#10;public class ProfileFragment extends Fragment {&#10;    private static final String TAG = &quot;ProfileFragment&quot;;&#10;    private FragmentProfileBinding binding;&#10;    private ProfileViewModel profileViewModel;&#10;&#10;    public View onCreateView(@NonNull LayoutInflater inflater,&#10;                             ViewGroup container, Bundle savedInstanceState) {&#10;        profileViewModel = new ViewModelProvider(requireActivity()).get(ProfileViewModel.class);&#10;        binding = FragmentProfileBinding.inflate(inflater, container, false);&#10;        View root = binding.getRoot();&#10;&#10;        Log.d(TAG, &quot;ProfileFragment onCreateView&quot;);&#10;&#10;        // Header: cập nhật tên, email&#10;        profileViewModel.getName().observe(getViewLifecycleOwner(), name -&gt; {&#10;            Log.d(TAG, &quot;Name changed in ViewModel: &quot; + name);&#10;            binding.tvName.setText(name);&#10;        });&#10;        profileViewModel.getEmail().observe(getViewLifecycleOwner(), email -&gt; {&#10;            Log.d(TAG, &quot;Email changed in ViewModel: &quot; + email);&#10;            binding.tvEmail.setText(email);&#10;        });&#10;&#10;        // Thống kê chuyến đi, quãng đường&#10;        profileViewModel.getRidesCount().observe(getViewLifecycleOwner(), count -&gt; binding.tvRidesCount.setText(String.valueOf(count)));&#10;        profileViewModel.getDistanceKm().observe(getViewLifecycleOwner(), d -&gt; binding.tvDistance.setText(d));&#10;&#10;        // Observe loading state&#10;        profileViewModel.getIsLoading().observe(getViewLifecycleOwner(), isLoading -&gt; {&#10;            if (isLoading != null &amp;&amp; isLoading) {&#10;                // Show loading indicator if you have one in layout&#10;                // binding.progressBar.setVisibility(View.VISIBLE);&#10;            } else {&#10;                // binding.progressBar.setVisibility(View.GONE);&#10;            }&#10;        });&#10;&#10;        // Observe error messages&#10;        profileViewModel.getErrorMessage().observe(getViewLifecycleOwner(), error -&gt; {&#10;            if (error != null &amp;&amp; !error.isEmpty()) {&#10;                Toast.makeText(getContext(), error, Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#10;&#10;        // Gán icon, tiêu đề, sự kiện cho từng mục menu&#10;        setupMenuItems(root);&#10;&#10;        // Sự kiện cho mục Cài Đặt (Chỉnh sửa hồ sơ)&#10;        LinearLayout llSettings = root.findViewById(R.id.llSettings);&#10;        if (llSettings != null) {&#10;            llSettings.setOnClickListener(v -&gt; {&#10;                NavHostFragment.findNavController(ProfileFragment.this)&#10;                        .navigate(R.id.navigation_edit_profile);&#10;            });&#10;        }&#10;&#10;        // Nút Đăng xuất&#10;        Button btnLogout = root.findViewById(R.id.btnLogout);&#10;        btnLogout.setOnClickListener(v -&gt; Toast.makeText(getContext(), &quot;Đăng xuất&quot;, Toast.LENGTH_SHORT).show());&#10;&#10;        return root;&#10;    }&#10;&#10;    private void setupMenuItems(View root) {&#10;        // Xác minh tài khoản&#10;        LinearLayout llVerify = root.findViewById(R.id.llVerify);&#10;        ((ImageView) llVerify.findViewById(R.id.ivMenuIcon)).setImageResource(R.drawable.ic_check_black_24dp);&#10;        ((TextView) llVerify.findViewById(R.id.tvMenuTitle)).setText(&quot;Xác minh tài khoản&quot;);&#10;        llVerify.setOnClickListener(v -&gt; {&#10;            Intent intent = new Intent(getActivity(), VerifyAccountActivity.class);&#10;            startActivity(intent);&#10;        });&#10;&#10;        // Lịch sử thuê xe&#10;        LinearLayout llHistory = root.findViewById(R.id.llHistory);&#10;        ((ImageView) llHistory.findViewById(R.id.ivMenuIcon)).setImageResource(R.drawable.ic_calendar_24dp);&#10;        ((TextView) llHistory.findViewById(R.id.tvMenuTitle)).setText(&quot;Lịch sử thuê xe&quot;);&#10;        llHistory.setOnClickListener(v -&gt; NavHostFragment.findNavController(ProfileFragment.this)&#10;                .navigate(R.id.navigation_booking_history));&#10;&#10;        // Cài đặt&#10;        LinearLayout llSettings = root.findViewById(R.id.llSettings);&#10;        ((ImageView) llSettings.findViewById(R.id.ivMenuIcon)).setImageResource(R.drawable.ic_settings);&#10;        ((TextView) llSettings.findViewById(R.id.tvMenuTitle)).setText(&quot;Cài đặt&quot;);&#10;        llSettings.setOnClickListener(v -&gt; NavHostFragment.findNavController(ProfileFragment.this)&#10;                .navigate(R.id.navigation_settings));&#10;&#10;        // Trợ giúp &amp; Hỗ trợ&#10;        LinearLayout llSupport = root.findViewById(R.id.llSupport);&#10;        ((ImageView) llSupport.findViewById(R.id.ivMenuIcon)).setImageResource(R.drawable.ic_search_24dp);&#10;        ((TextView) llSupport.findViewById(R.id.tvMenuTitle)).setText(&quot;Trợ giúp &amp; Hỗ trợ&quot;);&#10;        llSupport.setOnClickListener(v -&gt; Toast.makeText(getContext(), &quot;Trợ giúp &amp; Hỗ trợ&quot;, Toast.LENGTH_SHORT).show());&#10;&#10;        // Về chúng tôi&#10;        LinearLayout llAbout = root.findViewById(R.id.llAbout);&#10;        ((ImageView) llAbout.findViewById(R.id.ivMenuIcon)).setImageResource(R.drawable.ic_home_black_24dp);&#10;        ((TextView) llAbout.findViewById(R.id.tvMenuTitle)).setText(&quot;Về chúng tôi&quot;);&#10;        llAbout.setOnClickListener(v -&gt; Toast.makeText(getContext(), &quot;Về chúng tôi&quot;, Toast.LENGTH_SHORT).show());&#10;    }&#10;&#10;    @Override&#10;    public void onResume() {&#10;        super.onResume();&#10;        Log.d(TAG, &quot;ProfileFragment onResume - reloading profile&quot;);&#10;        // Reload profile data from API when fragment resumes&#10;        if (profileViewModel != null) {&#10;            profileViewModel.loadUserProfile();&#10;        }&#10;    }&#10;&#10;    @Override&#10;    public void onDestroyView() {&#10;        super.onDestroyView();&#10;        binding = null;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/bg_status_badge.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/bg_status_badge.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    android:shape=&quot;rectangle&quot;&gt;&#10;    &lt;corners android:radius=&quot;6dp&quot; /&gt;&#10;    &lt;solid android:color=&quot;@android:color/transparent&quot; /&gt;&#10;&lt;/shape&gt;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/ic_car_placeholder.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/ic_car_placeholder.xml" />
              <option name="updatedContent" value="&lt;vector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    android:width=&quot;24dp&quot;&#10;    android:height=&quot;24dp&quot;&#10;    android:viewportWidth=&quot;24&quot;&#10;    android:viewportHeight=&quot;24&quot;&gt;&#10;    &lt;path&#10;        android:fillColor=&quot;@color/gray_400&quot;&#10;        android:pathData=&quot;M18.92,6.01C18.72,5.42 18.16,5 17.5,5h-11C5.84,5 5.28,5.42 5.08,6.01L3,12v8c0,0.55 0.45,1 1,1h1c0.55,0 1,-0.45 1,-1v-1h12v1c0,0.55 0.45,1 1,1h1c0.55,0 1,-0.45 1,-1v-8L18.92,6.01zM6.5,16C5.67,16 5,15.33 5,14.5S5.67,13 6.5,13 8,13.67 8,14.5 7.33,16 6.5,16zM17.5,16c-0.83,0 -1.5,-0.67 -1.5,-1.5s0.67,-1.5 1.5,-1.5 1.5,0.67 1.5,1.5 -0.67,1.5 -1.5,1.5zM5,11l1.5,-4.5h11L19,11H5z&quot;/&gt;&#10;&lt;/vector&gt;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/drawable/ic_chevron_right_24dp.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/drawable/ic_chevron_right_24dp.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;vector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    android:width=&quot;24dp&quot;&#10;    android:height=&quot;24dp&quot;&#10;    android:viewportWidth=&quot;24&quot;&#10;    android:viewportHeight=&quot;24&quot;&gt;&#10;    &lt;path&#10;        android:fillColor=&quot;#2196F3&quot;&#10;        android:pathData=&quot;M9.29,6.71a1,1 0 0,0 0,1.41L13.17,12l-3.88,3.88a1,1 0 1,0 1.41,1.41l4.59,-4.59a1,1 0 0,0 0,-1.41l-4.59,-4.59a1,1 0 0,0 -1.41,0z&quot;/&gt;&#10;&lt;/vector&gt;&#10;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;vector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    android:width=&quot;24dp&quot;&#10;    android:height=&quot;24dp&quot;&#10;    android:viewportWidth=&quot;24&quot;&#10;    android:viewportHeight=&quot;24&quot;&gt;&#10;    &lt;path&#10;        android:fillColor=&quot;#2196F3&quot;&#10;        android:pathData=&quot;M9.29,6.71a1,1 0 0,0 0,1.41L13.17,12l-3.88,3.88a1,1 0 1,0 1.41,1.41l4.59,-4.59a1,1 0 0,0 0,-1.41l-4.59,-4.59a1,1 0 0,0 -1.41,0z&quot;/&gt;&#10;&lt;/vector&gt;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/layout/item_booking.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/layout/item_booking.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;androidx.cardview.widget.CardView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;wrap_content&quot;&#10;    android:layout_margin=&quot;8dp&quot;&#10;    app:cardCornerRadius=&quot;12dp&quot;&#10;    app:cardElevation=&quot;2dp&quot;&#10;    app:cardBackgroundColor=&quot;@color/white&quot;&gt;&#10;&#10;    &lt;LinearLayout&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:orientation=&quot;vertical&quot;&#10;        android:padding=&quot;16dp&quot;&gt;&#10;&#10;        &lt;!-- Header with vehicle image and name --&gt;&#10;        &lt;LinearLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:orientation=&quot;horizontal&quot;&#10;            android:gravity=&quot;center_vertical&quot;&gt;&#10;&#10;            &lt;ImageView&#10;                android:id=&quot;@+id/ivVehicleImage&quot;&#10;                android:layout_width=&quot;60dp&quot;&#10;                android:layout_height=&quot;60dp&quot;&#10;                android:scaleType=&quot;centerCrop&quot;&#10;                android:src=&quot;@drawable/ic_car_placeholder&quot;&#10;                android:contentDescription=&quot;Vehicle image&quot; /&gt;&#10;&#10;            &lt;LinearLayout&#10;                android:layout_width=&quot;0dp&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:layout_weight=&quot;1&quot;&#10;                android:orientation=&quot;vertical&quot;&#10;                android:layout_marginStart=&quot;12dp&quot;&gt;&#10;&#10;                &lt;TextView&#10;                    android:id=&quot;@+id/tvVehicleName&quot;&#10;                    android:layout_width=&quot;wrap_content&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:text=&quot;Honda SH 2024&quot;&#10;                    android:textColor=&quot;@color/gray_900&quot;&#10;                    android:textSize=&quot;16sp&quot;&#10;                    android:textStyle=&quot;bold&quot; /&gt;&#10;&#10;                &lt;TextView&#10;                    android:id=&quot;@+id/tvBookingId&quot;&#10;                    android:layout_width=&quot;wrap_content&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:text=&quot;ID: #12345&quot;&#10;                    android:textColor=&quot;@color/gray_600&quot;&#10;                    android:textSize=&quot;13sp&quot;&#10;                    android:layout_marginTop=&quot;2dp&quot; /&gt;&#10;&#10;            &lt;/LinearLayout&gt;&#10;&#10;            &lt;TextView&#10;                android:id=&quot;@+id/tvBookingStatus&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;ACTIVE&quot;&#10;                android:textSize=&quot;12sp&quot;&#10;                android:textStyle=&quot;bold&quot;&#10;                android:paddingStart=&quot;8dp&quot;&#10;                android:paddingEnd=&quot;8dp&quot;&#10;                android:paddingTop=&quot;4dp&quot;&#10;                android:paddingBottom=&quot;4dp&quot;&#10;                android:background=&quot;@drawable/bg_status_badge&quot;&#10;                android:textColor=&quot;@color/primary_blue&quot; /&gt;&#10;&#10;        &lt;/LinearLayout&gt;&#10;&#10;        &lt;!-- Divider --&gt;&#10;        &lt;View&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;1dp&quot;&#10;            android:layout_marginTop=&quot;12dp&quot;&#10;            android:layout_marginBottom=&quot;12dp&quot;&#10;            android:background=&quot;@color/gray_200&quot; /&gt;&#10;&#10;        &lt;!-- Booking details --&gt;&#10;        &lt;LinearLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:orientation=&quot;horizontal&quot;&gt;&#10;&#10;            &lt;!-- Pickup info --&gt;&#10;            &lt;LinearLayout&#10;                android:layout_width=&quot;0dp&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:layout_weight=&quot;1&quot;&#10;                android:orientation=&quot;vertical&quot;&gt;&#10;&#10;                &lt;TextView&#10;                    android:layout_width=&quot;wrap_content&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:text=&quot;Ngày nhận&quot;&#10;                    android:textSize=&quot;12sp&quot;&#10;                    android:textColor=&quot;@color/gray_600&quot; /&gt;&#10;&#10;                &lt;TextView&#10;                    android:id=&quot;@+id/tvPickupDate&quot;&#10;                    android:layout_width=&quot;wrap_content&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:text=&quot;01/11/2024&quot;&#10;                    android:textSize=&quot;14sp&quot;&#10;                    android:textColor=&quot;@color/gray_900&quot;&#10;                    android:textStyle=&quot;bold&quot;&#10;                    android:layout_marginTop=&quot;4dp&quot; /&gt;&#10;&#10;                &lt;TextView&#10;                    android:id=&quot;@+id/tvPickupTime&quot;&#10;                    android:layout_width=&quot;wrap_content&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:text=&quot;09:00&quot;&#10;                    android:textSize=&quot;13sp&quot;&#10;                    android:textColor=&quot;@color/gray_700&quot;&#10;                    android:layout_marginTop=&quot;2dp&quot; /&gt;&#10;&#10;            &lt;/LinearLayout&gt;&#10;&#10;            &lt;!-- Return info --&gt;&#10;            &lt;LinearLayout&#10;                android:layout_width=&quot;0dp&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:layout_weight=&quot;1&quot;&#10;                android:orientation=&quot;vertical&quot;&gt;&#10;&#10;                &lt;TextView&#10;                    android:layout_width=&quot;wrap_content&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:text=&quot;Ngày trả&quot;&#10;                    android:textSize=&quot;12sp&quot;&#10;                    android:textColor=&quot;@color/gray_600&quot; /&gt;&#10;&#10;                &lt;TextView&#10;                    android:id=&quot;@+id/tvReturnDate&quot;&#10;                    android:layout_width=&quot;wrap_content&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:text=&quot;05/11/2024&quot;&#10;                    android:textSize=&quot;14sp&quot;&#10;                    android:textColor=&quot;@color/gray_900&quot;&#10;                    android:textStyle=&quot;bold&quot;&#10;                    android:layout_marginTop=&quot;4dp&quot; /&gt;&#10;&#10;                &lt;TextView&#10;                    android:id=&quot;@+id/tvReturnTime&quot;&#10;                    android:layout_width=&quot;wrap_content&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:text=&quot;18:00&quot;&#10;                    android:textSize=&quot;13sp&quot;&#10;                    android:textColor=&quot;@color/gray_700&quot;&#10;                    android:layout_marginTop=&quot;2dp&quot; /&gt;&#10;&#10;            &lt;/LinearLayout&gt;&#10;&#10;        &lt;/LinearLayout&gt;&#10;&#10;        &lt;!-- Total price --&gt;&#10;        &lt;TextView&#10;            android:id=&quot;@+id/tvTotalPrice&quot;&#10;            android:layout_width=&quot;wrap_content&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:text=&quot;500.000 ₫&quot;&#10;            android:textSize=&quot;18sp&quot;&#10;            android:textStyle=&quot;bold&quot;&#10;            android:textColor=&quot;@color/primary_blue&quot;&#10;            android:layout_marginTop=&quot;12dp&quot; /&gt;&#10;&#10;        &lt;!-- Buttons --&gt;&#10;        &lt;LinearLayout&#10;            android:layout_width=&quot;match_parent&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:orientation=&quot;horizontal&quot;&#10;            android:layout_marginTop=&quot;12dp&quot;&gt;&#10;&#10;            &lt;Button&#10;                android:id=&quot;@+id/btnViewDetails&quot;&#10;                android:layout_width=&quot;0dp&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:layout_weight=&quot;1&quot;&#10;                android:text=&quot;Chi tiết&quot;&#10;                android:textSize=&quot;14sp&quot;&#10;                style=&quot;@style/Widget.MaterialComponents.Button.OutlinedButton&quot;&#10;                android:layout_marginEnd=&quot;8dp&quot; /&gt;&#10;&#10;            &lt;Button&#10;                android:id=&quot;@+id/btnCancelBooking&quot;&#10;                android:layout_width=&quot;0dp&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:layout_weight=&quot;1&quot;&#10;                android:text=&quot;Hủy đơn&quot;&#10;                android:textSize=&quot;14sp&quot;&#10;                android:backgroundTint=&quot;@color/red_500&quot;&#10;                style=&quot;@style/Widget.MaterialComponents.Button&quot; /&gt;&#10;&#10;        &lt;/LinearLayout&gt;&#10;&#10;    &lt;/LinearLayout&gt;&#10;&#10;&lt;/androidx.cardview.widget.CardView&gt;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/layout/item_booking_history.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/layout/item_booking_history.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;androidx.cardview.widget.CardView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#10;    android:id=&quot;@+id/cardBookingHistory&quot;&#10;    android:layout_width=&quot;match_parent&quot;&#10;    android:layout_height=&quot;wrap_content&quot;&#10;    android:layout_margin=&quot;8dp&quot;&#10;    app:cardCornerRadius=&quot;12dp&quot;&#10;    app:cardElevation=&quot;2dp&quot;&#10;    app:cardBackgroundColor=&quot;@color/white&quot;&gt;&#10;&#10;    &lt;LinearLayout&#10;        android:layout_width=&quot;match_parent&quot;&#10;        android:layout_height=&quot;wrap_content&quot;&#10;        android:orientation=&quot;horizontal&quot;&#10;        android:padding=&quot;12dp&quot;&gt;&#10;&#10;        &lt;!-- Vehicle Image --&gt;&#10;        &lt;com.google.android.material.card.MaterialCardView&#10;            android:layout_width=&quot;80dp&quot;&#10;            android:layout_height=&quot;80dp&quot;&#10;            app:cardCornerRadius=&quot;8dp&quot;&#10;            app:strokeWidth=&quot;0dp&quot;&gt;&#10;&#10;            &lt;ImageView&#10;                android:id=&quot;@+id/ivVehicleHistory&quot;&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;match_parent&quot;&#10;                android:scaleType=&quot;centerCrop&quot;&#10;                android:src=&quot;@drawable/ic_car_placeholder&quot;&#10;                android:contentDescription=&quot;Vehicle image&quot; /&gt;&#10;&#10;        &lt;/com.google.android.material.card.MaterialCardView&gt;&#10;&#10;        &lt;!-- Booking Info --&gt;&#10;        &lt;LinearLayout&#10;            android:layout_width=&quot;0dp&quot;&#10;            android:layout_height=&quot;wrap_content&quot;&#10;            android:layout_weight=&quot;1&quot;&#10;            android:orientation=&quot;vertical&quot;&#10;            android:layout_marginStart=&quot;12dp&quot;&gt;&#10;&#10;            &lt;TextView&#10;                android:id=&quot;@+id/tvVehicleNameHistory&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;Honda SH 2024&quot;&#10;                android:textColor=&quot;@color/gray_900&quot;&#10;                android:textSize=&quot;16sp&quot;&#10;                android:textStyle=&quot;bold&quot;&#10;                android:fontFamily=&quot;sans-serif-medium&quot;&#10;                android:maxLines=&quot;1&quot;&#10;                android:ellipsize=&quot;end&quot; /&gt;&#10;&#10;            &lt;TextView&#10;                android:id=&quot;@+id/tvVehicleInfoHistory&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;Honda SH • 2024&quot;&#10;                android:textColor=&quot;@color/gray_600&quot;&#10;                android:textSize=&quot;13sp&quot;&#10;                android:layout_marginTop=&quot;2dp&quot;&#10;                android:maxLines=&quot;1&quot;&#10;                android:ellipsize=&quot;end&quot; /&gt;&#10;&#10;            &lt;TextView&#10;                android:id=&quot;@+id/tvDateRangeHistory&quot;&#10;                android:layout_width=&quot;wrap_content&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:text=&quot;01/11/2024 - 05/11/2024&quot;&#10;                android:textColor=&quot;@color/gray_700&quot;&#10;                android:textSize=&quot;13sp&quot;&#10;                android:layout_marginTop=&quot;4dp&quot;&#10;                android:drawableStart=&quot;@drawable/ic_calendar_24dp&quot;&#10;                android:drawablePadding=&quot;4dp&quot;&#10;                android:drawableTint=&quot;@color/gray_600&quot;&#10;                android:gravity=&quot;center_vertical&quot; /&gt;&#10;&#10;            &lt;LinearLayout&#10;                android:layout_width=&quot;match_parent&quot;&#10;                android:layout_height=&quot;wrap_content&quot;&#10;                android:orientation=&quot;horizontal&quot;&#10;                android:layout_marginTop=&quot;4dp&quot;&#10;                android:gravity=&quot;center_vertical&quot;&gt;&#10;&#10;                &lt;TextView&#10;                    android:id=&quot;@+id/tvTotalPriceHistory&quot;&#10;                    android:layout_width=&quot;0dp&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:layout_weight=&quot;1&quot;&#10;                    android:text=&quot;500.000 ₫&quot;&#10;                    android:textColor=&quot;@color/primary_blue&quot;&#10;                    android:textSize=&quot;15sp&quot;&#10;                    android:textStyle=&quot;bold&quot;&#10;                    android:fontFamily=&quot;sans-serif-medium&quot; /&gt;&#10;&#10;                &lt;TextView&#10;                    android:id=&quot;@+id/tvStatusHistory&quot;&#10;                    android:layout_width=&quot;wrap_content&quot;&#10;                    android:layout_height=&quot;wrap_content&quot;&#10;                    android:text=&quot;Hoàn thành&quot;&#10;                    android:textSize=&quot;12sp&quot;&#10;                    android:textStyle=&quot;bold&quot;&#10;                    android:paddingStart=&quot;8dp&quot;&#10;                    android:paddingEnd=&quot;8dp&quot;&#10;                    android:paddingTop=&quot;4dp&quot;&#10;                    android:paddingBottom=&quot;4dp&quot;&#10;                    android:background=&quot;@drawable/bg_status_badge&quot;&#10;                    android:textColor=&quot;@color/green_500&quot; /&gt;&#10;&#10;            &lt;/LinearLayout&gt;&#10;&#10;        &lt;/LinearLayout&gt;&#10;&#10;    &lt;/LinearLayout&gt;&#10;&#10;&lt;/androidx.cardview.widget.CardView&gt;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/navigation/mobile_navigation.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/navigation/mobile_navigation.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;navigation xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#10;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&#10;    android:id=&quot;@+id/mobile_navigation&quot;&#10;    app:startDestination=&quot;@+id/navigation_home&quot;&gt;&#10;&#10;    &lt;fragment&#10;        android:id=&quot;@+id/navigation_home&quot;&#10;        android:name=&quot;com.example.prm_project.ui.home.HomeFragment&quot;&#10;        android:label=&quot;@string/title_home&quot;&#10;        tools:layout=&quot;@layout/fragment_home&quot; /&gt;&#10;&#10;    &lt;fragment&#10;        android:id=&quot;@+id/navigation_search&quot;&#10;        android:name=&quot;com.example.prm_project.ui.search.SearchFragment&quot;&#10;        android:label=&quot;@string/title_search&quot;&#10;        tools:layout=&quot;@layout/fragment_search&quot; /&gt;&#10;&#10;    &lt;fragment&#10;        android:id=&quot;@+id/navigation_booking&quot;&#10;        android:name=&quot;com.example.prm_project.ui.booking.BookingFragment&quot;&#10;        android:label=&quot;@string/title_booking&quot;&#10;        tools:layout=&quot;@layout/fragment_booking&quot; /&gt;&#10;&#10;    &lt;fragment&#10;        android:id=&quot;@+id/navigation_profile&quot;&#10;        android:name=&quot;com.example.prm_project.ui.profile.ProfileFragment&quot;&#10;        android:label=&quot;@string/title_profile&quot;&#10;        tools:layout=&quot;@layout/fragment_profile&quot; /&gt;&#10;&#10;    &lt;fragment&#10;        android:id=&quot;@+id/navigation_edit_profile&quot;&#10;        android:name=&quot;com.example.prm_project.ui.profile.EditProfileFragment&quot;&#10;        android:label=&quot;@string/title_edit_profile&quot;&#10;        tools:layout=&quot;@layout/fragment_edit_profile&quot; /&gt;&#10;&#10;    &lt;fragment&#10;        android:id=&quot;@+id/navigation_settings&quot;&#10;        android:name=&quot;com.example.prm_project.ui.profile.SettingsFragment&quot;&#10;        android:label=&quot;@string/settings&quot;&#10;        tools:layout=&quot;@layout/fragment_settings&quot; /&gt;&#10;&lt;/navigation&gt;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;navigation xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#13;&#10;    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&#13;&#10;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&#13;&#10;    android:id=&quot;@+id/mobile_navigation&quot;&#13;&#10;    app:startDestination=&quot;@+id/navigation_home&quot;&gt;&#13;&#10;&#13;&#10;    &lt;fragment&#13;&#10;        android:id=&quot;@+id/navigation_home&quot;&#13;&#10;        android:name=&quot;com.example.prm_project.ui.home.HomeFragment&quot;&#13;&#10;        android:label=&quot;@string/title_home&quot;&#13;&#10;        tools:layout=&quot;@layout/fragment_home&quot; /&gt;&#13;&#10;&#13;&#10;    &lt;fragment&#13;&#10;        android:id=&quot;@+id/navigation_search&quot;&#13;&#10;        android:name=&quot;com.example.prm_project.ui.search.SearchFragment&quot;&#13;&#10;        android:label=&quot;@string/title_search&quot;&#13;&#10;        tools:layout=&quot;@layout/fragment_search&quot; /&gt;&#13;&#10;&#13;&#10;    &lt;fragment&#13;&#10;        android:id=&quot;@+id/navigation_booking&quot;&#13;&#10;        android:name=&quot;com.example.prm_project.ui.booking.BookingFragment&quot;&#13;&#10;        android:label=&quot;@string/title_booking&quot;&#13;&#10;        tools:layout=&quot;@layout/fragment_booking&quot; /&gt;&#13;&#10;&#13;&#10;    &lt;fragment&#13;&#10;        android:id=&quot;@+id/navigation_profile&quot;&#13;&#10;        android:name=&quot;com.example.prm_project.ui.profile.ProfileFragment&quot;&#13;&#10;        android:label=&quot;@string/title_profile&quot;&#13;&#10;        tools:layout=&quot;@layout/fragment_profile&quot; /&gt;&#13;&#10;&#13;&#10;    &lt;fragment&#13;&#10;        android:id=&quot;@+id/navigation_edit_profile&quot;&#13;&#10;        android:name=&quot;com.example.prm_project.ui.profile.EditProfileFragment&quot;&#13;&#10;        android:label=&quot;@string/title_edit_profile&quot;&#13;&#10;        tools:layout=&quot;@layout/fragment_edit_profile&quot; /&gt;&#13;&#10;&#13;&#10;    &lt;fragment&#13;&#10;        android:id=&quot;@+id/navigation_settings&quot;&#13;&#10;        android:name=&quot;com.example.prm_project.ui.profile.SettingsFragment&quot;&#13;&#10;        android:label=&quot;@string/settings&quot;&#13;&#10;        tools:layout=&quot;@layout/fragment_settings&quot; /&gt;&#13;&#10;&#13;&#10;    &lt;fragment&#13;&#10;        android:id=&quot;@+id/navigation_booking_history&quot;&#13;&#10;        android:name=&quot;com.example.prm_project.ui.bookings.BookingHistoryFragment&quot;&#13;&#10;        android:label=&quot;Lịch sử thuê xe&quot;&#13;&#10;        tools:layout=&quot;@layout/fragment_booking_history&quot; /&gt;&#13;&#10;&lt;/navigation&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>